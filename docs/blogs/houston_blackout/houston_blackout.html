<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Raymond Hunter">
<meta name="dcterms.date" content="2023-12-15">
<meta name="description" content="an investigation of environmental injustice">

<title>A Spatial Analysis of Houston Blackouts and the Communities it Affected</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/logo.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resume.html" rel="" target="">
 <span class="menu-text">Resume</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blogs.html" rel="" target="">
 <span class="menu-text">My Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/raymond-hunter-90a8081a7/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ramhunte" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:ramhunte@bren.ucsb.edu" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background">Background</a></li>
  <li><a href="#goal" id="toc-goal" class="nav-link" data-scroll-target="#goal">Goal</a></li>
  <li><a href="#approach" id="toc-approach" class="nav-link" data-scroll-target="#approach">Approach</a>
  <ul class="collapse">
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  </ul></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis">Analysis</a>
  <ul class="collapse">
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">A Spatial Analysis of Houston Blackouts and the Communtiies it Affected</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">Quarto</div>
    <div class="quarto-category">R</div>
  </div>
  </div>

<div>
  <div class="description">
    an investigation of environmental injustice
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p><a href="https://ramhunte.github.io/">Raymond Hunter</a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 15, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p><a href="https://github.com/ramhunte/houston_blackout">Github project repository</a></p>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>Natural disasters oftentimes occur unpredictably and rapidly, and the severity of them can vary widely. Specifically in the Southern United States, major storms (like Hurricane Katrina) can have devastating and long lasting consequences on communities.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> “In February 2021, the state of Texas suffered a major power crisis, which came about as a result of three severe winter storms sweeping across the United States on February 10–11, 13–17, and 15–20.”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. While these storms seem like once in a blue moon events, they are becoming much more of a normal occurrence. More importantly, storms do not impact all communities the same, and therefore it is critical that we incorporate racial justice components to our lines of environmental analysese to understand how we can mitigate marginalized groups from being disproportianately harmed from climate change.</p>
</section>
<section id="goal" class="level2">
<h2 class="anchored" data-anchor-id="goal">Goal</h2>
<p>The goal of this study is to try and answer the question: <strong>Which communities in Houston experienced blackouts from the February 2021 storms, and did they vary by socioeconomic status?</strong> Other studies have shown that not only do lower socioeconomic status communities experience more intense consequences of natural disaster, but they also don’t always receive the same degree of aid following one.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p>By identifying the total number of houses in Houston that lost power and overlaying socioeconomic data to these homes, we can begin to look at these underlying patterns of potential environmental injustice. These types of studies are becoming critically important as climate change continues to increase the frequency of severe storms including intense precipitation events throughout Texas<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> as not all communities are affected the same. We need to look at how communities of varying socioeconomic status are impacted as a result.</p>
</section>
<section id="approach" class="level2">
<h2 class="anchored" data-anchor-id="approach">Approach</h2>
<p>I used remotely-sensed night lights data from before and after the storms to estimate power outages. Data was acquired from the <a href="https://en.wikipedia.org/wiki/Visible_Infrared_Imaging_Radiometer_Suite">Visible Infrared Imaging Radiometer Suite (VIIRS)</a> from the Suomi satellite. I used the VNP46A1 tolook for variation in night lights before and after the storm as a way of identifying areas that lost electric power as a result of the storms. Furthermore, data containing the physical boundaires and area of buildings and roads is needed to spatially join to areas that lost power. I gathered this data from <a href="https://www.openstreetmap.org/#map=4/38.01/-95.84">OpenStreetMap</a> providing high resolution data on the structural layout of the city. Finally, we need to join this data with socioeconomic factor data pertaining to all the communities in Houston affected by the blackouts. I pulled this data from the US Census Bureau (see <code>Readme</code> file) that shows block group county level information on various socioeconomic characterisitcs.</p>
<p>These types of analysis require a variety of different tools to carry out from satellite images and census data to finalized maps. Some of the most important tools in carrying out this analysis include: * loading, transforming, and wrangling vector/raster data * raster operations to identify blackout areas from satellite imagery * vector operations to isolate affected buildings and remove interference (road lights) * spatial joins of regions experiencing blackouts and the total number of untis within them</p>
<section id="data" class="level3">
<h3 class="anchored" data-anchor-id="data">Data</h3>
<section id="night-lights" class="level4">
<h4 class="anchored" data-anchor-id="night-lights">Night lights</h4>
<p>Using NASA’s Worldview to find data pre and post storm, I found satellite images recorded on 2021-02-07 and 2021-02-16 that provided two clear, contrasting images to visualize the extent of the power outage in Texas. VIIRS data is distributed through NASA’s <a href="https://ladsweb.modaps.eosdis.nasa.gov/">Level-1 and Atmospheric Archive &amp; Distribution System Distributed Active Archive Center (LAADS DAAC)</a>. Many NASA Earth data products are distributed in 10x10 degree tiles in sinusoidal equal-area projection that are identified by their horizontal and vertical position in the grid. Houston lies on the border of tiles h08v05 and h08v06, and so I downloaded two tiles per date to ensure the whole city was being included. These data are stored in the <code>VNP46A1</code> folder:</p>
<ul>
<li><code>VNP46A1.A2021038.h08v05.001.2021039064328.h5.tif</code>: tile h08v05, collected on 2021-02-07<br>
</li>
<li><code>VNP46A1.A2021038.h08v06.001.2021039064329.h5.tif</code>: tile h08v06, collected on 2021-02-07<br>
</li>
<li><code>VNP46A1.A2021047.h08v05.001.2021048091106.h5.tif</code>: tile h08v05, collected on 2021-02-16<br>
</li>
<li><code>VNP46A1.A2021047.h08v06.001.2021048091105.h5.tif</code>: tile h08v06, collected on 2021-02-16</li>
</ul>
</section>
<section id="roads" class="level4">
<h4 class="anchored" data-anchor-id="roads">Roads</h4>
<p>One issue with night light data is that light pollution can interfere with detecting patterns of interest. Highways make up much of the night lights seen from space (see Google’s <a href="https://earth.google.com/web/@27.44405464,-84.7693044,206.63660162a,8916361.52264659d,35y,0h,0t,0r/data=CiQSIhIgMGY3ZTJkYzdlOGExMTFlNjk5MGQ2ZjgxOGQ2OWE2ZTc">Earth at Night</a>). Therefore, it is important to minimize falsely identifying areas with reduced traffic as areas without power. <a href="https://planet.openstreetmap.org/">OpenStreetMap (OSM)</a> is a collaborative project which creates publicly available geographic data of the world. I used <a href="https://download.geofabrik.de/">Geofabrik’s download sites</a> to retrieve a shapefile of all highways in Texas and prepared a Geopackage (<code>.gpkg</code> file) containing just the subset of roads that intersect the Houston metropolitan area.</p>
<ul>
<li><code>gis_osm_roads_free_1.gpkg</code></li>
</ul>
</section>
<section id="houses" class="level4">
<h4 class="anchored" data-anchor-id="houses">Houses</h4>
<p>I also obtained building data from OpenStreetMap. Again, I downloaded from Geofabrick and prepared a GeoPackage containing only houses in the Houston metropolitan area.<br>
</p>
<ul>
<li><code>gis_osm_buildings_a_free_1.gpkg</code></li>
</ul>
</section>
<section id="socioeconomic" class="level4">
<h4 class="anchored" data-anchor-id="socioeconomic">Socioeconomic</h4>
<p>I used data from the <a href="https://www.census.gov/programs-surveys/acs">U.S. Census Bureau’s American Community Survey</a> for census tracts in 2019 to reoresent socioeconomic data of different regions of Houston. The <em>folder</em> <code>ACS_2019_5YR_TRACT_48.gdb</code> is an ArcGIS <a href="https://desktop.arcgis.com/en/arcmap/latest/manage-data/administer-file-gdbs/file-geodatabases.htm">“file geodatabase”</a>, a multi-file proprietary format that’s roughly analogous to a GeoPackage file. Each layer contains a subset of the fields documents in the <a href="https://www2.census.gov/geo/docs/maps-data/data/tiger/prejoined/ACSMetadata2011.txt">ACS metadata</a>. The geodatabase contains a layer holding the geometry information, separate from the layers holding the ACS attributes. You have to combine the geometry with the attributes to get a feature layer that <code>sf</code> can use.</p>
</section>
</section>
</section>
<section id="analysis" class="level2">
<h2 class="anchored" data-anchor-id="analysis">Analysis</h2>
<section id="find-locations-of-blackouts" class="level4">
<h4 class="anchored" data-anchor-id="find-locations-of-blackouts">Find locations of blackouts</h4>
<section id="combine-the-data" class="level5">
<h5 class="anchored" data-anchor-id="combine-the-data">combine the data</h5>
<p>First, I read in the night lights tiles data and combining them into a single <code>stars</code> object for each date (2021-02-07 and 2021-02-16).</p>
<div class="cell">
<details>
<summary>code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">#reading in raster data </span></span>
<span id="cb1-2"><a href="#cb1-2"></a>t1 <span class="ot">=</span> <span class="fu">read_stars</span>(<span class="fu">file.path</span>(data, <span class="st">"VNP46A1/VNP46A1.A2021038.h08v05.001.2021039064328.tif"</span>))</span>
<span id="cb1-3"><a href="#cb1-3"></a>t2 <span class="ot">=</span> <span class="fu">read_stars</span>(<span class="fu">file.path</span>(data,<span class="st">"VNP46A1/VNP46A1.A2021038.h08v06.001.2021039064329.tif"</span>))</span>
<span id="cb1-4"><a href="#cb1-4"></a>t3 <span class="ot">=</span> <span class="fu">read_stars</span>(<span class="fu">file.path</span>(data,<span class="st">"VNP46A1/VNP46A1.A2021047.h08v05.001.2021048091106.tif"</span>))</span>
<span id="cb1-5"><a href="#cb1-5"></a>t4 <span class="ot">=</span> <span class="fu">read_stars</span>(<span class="fu">file.path</span>(data,<span class="st">"VNP46A1/VNP46A1.A2021047.h08v06.001.2021048091105.tif"</span>))</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">#creating a mosaic of houston raster data for both days </span></span>
<span id="cb1-8"><a href="#cb1-8"></a>lights_mos1 <span class="ot">&lt;-</span> <span class="fu">st_mosaic</span>(t1, t2)</span>
<span id="cb1-9"><a href="#cb1-9"></a>lights_mos2 <span class="ot">&lt;-</span> <span class="fu">st_mosaic</span>(t3, t4)</span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co"># plot(lights_mos1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="create-a-blackout-mask" class="level5">
<h5 class="anchored" data-anchor-id="create-a-blackout-mask">create a blackout mask</h5>
<p>I then found the change in night lights intensity (presumably) caused by the storm. I first reclassified a difference raster, assuming that any location that experienced a drop of more than 200 nW cm<sup>-2</sup>sr<sup>-1</sup> experienced a blackout. <code>NA</code> values were to all locations that experienced a drop of <em>less</em> than 200 nW cm<sup>-2</sup>sr<sup>-1</sup>.</p>
<div class="cell">
<details>
<summary>code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">#finding difference in light intensity by subtracting light difference </span></span>
<span id="cb2-2"><a href="#cb2-2"></a>light_diff <span class="ot">&lt;-</span> lights_mos1 <span class="sc">-</span> lights_mos2</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># plot(light_diff)</span></span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#reclassify raster to give NA values to locations that did not experience a blackout</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>light_diff[light_diff <span class="sc">&lt;</span> <span class="dv">200</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb2-8"><a href="#cb2-8"></a></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co"># plot(light_diff)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="vectorize-the-mask" class="level5">
<h5 class="anchored" data-anchor-id="vectorize-the-mask">vectorize the mask</h5>
<p>I vectorized the the blackout mask and fixed any invalid geometries using <code>st_make_valid</code>. I then inspected it to make sure it was an sf object and to look at its characteristics.</p>
<div class="cell">
<details>
<summary>code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">#creating a black out mask as a sf object. This creates a mask of geometries that experienced a black out</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>bo_mask <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(light_diff)</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#making sure geometries are valid</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="fu">st_make_valid</span>(bo_mask)</span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#making sure new object is an sf and inspecting it</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="fu">class</span>(bo_mask)</span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co"># plot(bo_mask)</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="fu">summary</span>(bo_mask)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="crop-the-vectorized-map-to-houston" class="level5">
<h5 class="anchored" data-anchor-id="crop-the-vectorized-map-to-houston">crop the vectorized map to Houston</h5>
<p>I defined the Houston metropolitan area with the following coordinates: (-96.5, 29), (-96.5, 30.5), (-94.5, 30.5), (-94.5, 29) and then turned them into a polygon using <code>st_polygon</code>. A CRS was then added to the polygon to make a simple features collection using <code>st_sfc()</code>. Lastly, I cropped (spatially subset) the blackout mask to our region of interest and re-project the cropped blackout dataset to EPSG:3083 (NAD83 / Texas Centric Albers Equal Area).</p>
<div class="cell">
<details>
<summary>code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">#creating a matrix of coordinates for houston</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#note: last coordinate need to be same as the first</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>hstn_cords <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">96.5</span>, <span class="dv">29</span>, <span class="sc">-</span><span class="fl">96.5</span>, <span class="fl">30.5</span>, <span class="sc">-</span><span class="fl">94.5</span>, <span class="fl">30.5</span>, <span class="sc">-</span><span class="fl">94.5</span>, <span class="dv">29</span>, <span class="sc">-</span><span class="fl">96.5</span>, <span class="dv">29</span>), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">#creating a polygon for houston </span></span>
<span id="cb4-6"><a href="#cb4-6"></a>hstn_poly <span class="ot">&lt;-</span> <span class="fu">st_polygon</span>(<span class="fu">list</span>(hstn_cords))</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="fu">class</span>(hstn_poly)</span>
<span id="cb4-9"><a href="#cb4-9"></a></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">#making a simple feature collection using same crs as bo_mask</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>hstn_sf <span class="ot">&lt;-</span> <span class="fu">st_sfc</span>(hstn_poly, <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb4-12"><a href="#cb4-12"></a></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="fu">class</span>(hstn_sf)</span>
<span id="cb4-14"><a href="#cb4-14"></a></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co">#cropping black out mask to the houston sf object </span></span>
<span id="cb4-16"><a href="#cb4-16"></a>bo_mask_houst <span class="ot">&lt;-</span> bo_mask[hstn_sf, ] </span>
<span id="cb4-17"><a href="#cb4-17"></a></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="co">#transforming crs to EPSG:3083 </span></span>
<span id="cb4-19"><a href="#cb4-19"></a>bo_mask_houst <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(bo_mask_houst, <span class="dv">3083</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="check-1-ensurign-that-the-mask-function-worked" class="level5">
<h5 class="anchored" data-anchor-id="check-1-ensurign-that-the-mask-function-worked">Check #1: Ensurign that the mask function worked</h5>
<div class="cell">
<details>
<summary>code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="do">##### creating a check ######</span></span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="fu">cat</span>(<span class="st">"CHECK #1 - see if raster data is masked within Houston:"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>CHECK #1 - see if raster data is masked within Houston: </code></pre>
</div>
<details>
<summary>code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(bo_mask_houst) <span class="sc">==</span> <span class="fu">nrow</span>(bo_mask)) {</span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">cat</span>(<span class="st">"No: mask did not work."</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a>} <span class="cf">else</span> {</span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">cat</span>(<span class="st">" Yes, all black out raster data lie within the Houston polygon."</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-5"><a href="#cb7-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Yes, all black out raster data lie within the Houston polygon. </code></pre>
</div>
</div>
<p><br> <br></p>
</section>
<section id="exclude-highways-from-blackout-mask" class="level5">
<h5 class="anchored" data-anchor-id="exclude-highways-from-blackout-mask">exclude highways from blackout mask</h5>
<p>The roads geopackage provoded includes data on roads other than highways. However, we can avoid reading in data we don’t need by taking advantage of <code>st_read</code>’s ability to subset using a SQL query. This allows us to save comutational energy by just pulling in relevant data we want.</p>
<p>First I defined a SQL query:</p>
<p><code>query &lt;- "SELECT * FROM gis_osm_roads_free_1 WHERE fclass='motorway'"</code></p>
<p>I applied to <code>st_read</code> to load just highway data from geopackage. I then reprojected the data to EPSG:3083 and identified areas within 200m of all highways using <code>st_buffer</code> and dissolved them with <code>st_union</code>. Lastly, I find areas that experienced blackouts that are further than 200m from a highway through spatial subsetting using the <code>st_disjoint</code> operation.</p>
<div class="cell">
<details>
<summary>code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">#assigning a query that pulls highway roads</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>highway_query <span class="ot">&lt;-</span> <span class="st">"SELECT * FROM gis_osm_roads_free_1 WHERE fclass='motorway'"</span></span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#reading in highway data </span></span>
<span id="cb9-5"><a href="#cb9-5"></a>highways <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">file.path</span>(data,<span class="st">"gis_osm_roads_free_1.gpkg"</span>), <span class="at">query =</span> highway_query, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#transforming highways crs to 3083</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>highways <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(highways, <span class="dv">3083</span>)</span>
<span id="cb9-9"><a href="#cb9-9"></a></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#creating a 200m buffer around highways </span></span>
<span id="cb9-11"><a href="#cb9-11"></a>high_buff <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(highways, <span class="at">dist =</span> <span class="dv">200</span>)</span>
<span id="cb9-12"><a href="#cb9-12"></a></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">#dissolveing buffers </span></span>
<span id="cb9-14"><a href="#cb9-14"></a>high_buff_dis <span class="ot">&lt;-</span> <span class="fu">st_union</span>(high_buff)</span>
<span id="cb9-15"><a href="#cb9-15"></a></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co"># plot(high_buff_dis)</span></span>
<span id="cb9-17"><a href="#cb9-17"></a></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co">#finding areas more than 200m from a highway that experienced a blackout </span></span>
<span id="cb9-19"><a href="#cb9-19"></a>mask_no_hwy <span class="ot">&lt;-</span> bo_mask_houst[high_buff_dis, op <span class="ot">=</span> st_disjoint]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="check-2-see-if-the-highway-exclusion-mask-removed-all-polygons-within-the-200m-of-highways" class="level5">
<h5 class="anchored" data-anchor-id="check-2-see-if-the-highway-exclusion-mask-removed-all-polygons-within-the-200m-of-highways">Check #2: see if the highway exclusion mask removed all polygons within the 200m of highways</h5>
<div class="cell">
<details>
<summary>code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="do">#### creating a check #######</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">cat</span>(<span class="st">"CHECK #2 - see if the highway exclusion mask removed all polygons within the 200m of highways:"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>CHECK #2 - see if the highway exclusion mask removed all polygons within the 200m of highways: </code></pre>
</div>
<details>
<summary>code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(mask_no_hwy) <span class="sc">+</span> <span class="fu">nrow</span>(bo_mask_houst[high_buff_dis, ]) <span class="sc">==</span> <span class="fu">nrow</span>(bo_mask_houst)) {</span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">cat</span>(<span class="st">"Yes, the highway mask removed all polygons within the 200m of highways."</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a>  } <span class="cf">else</span> {</span>
<span id="cb12-4"><a href="#cb12-4"></a>    <span class="fu">cat</span>(<span class="st">"Error! Observations within highway mask are included."</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-5"><a href="#cb12-5"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Yes, the highway mask removed all polygons within the 200m of highways. </code></pre>
</div>
</div>
<p><br> <br></p>
</section>
</section>
<section id="find-homes-impacted-by-blackouts" class="level4">
<h4 class="anchored" data-anchor-id="find-homes-impacted-by-blackouts">Find homes impacted by blackouts</h4>
<section id="load-buildings-data" class="level5">
<h5 class="anchored" data-anchor-id="load-buildings-data">load buildings data</h5>
<p>The buildings dataset was then loaded in using <code>st_read</code> and the following SQL query:</p>
<p><code>SELECT *</code>&nbsp; <code>FROM gis_osm_buildings_a_free_1</code> <code>WHERE (type IS NULL AND name IS NULL)</code> <code>OR type in ('residential', 'apartments', 'house', 'static_caravan', 'detached')</code><br>
</p>
<p>Again, this reduces the amount of data pulled inoto R, saving us time, energy, and storage.</p>
<div class="cell">
<details>
<summary>code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co">#making a query for pulling specific building data</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>buildings_query <span class="ot">&lt;-</span> <span class="st">"SELECT * FROM gis_osm_buildings_a_free_1 WHERE (type IS NULL AND name IS NULL) OR type in ('residential', 'apartments', 'house', 'static_caravan', 'detached')"</span></span>
<span id="cb14-3"><a href="#cb14-3"></a></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co">#reading in building data </span></span>
<span id="cb14-5"><a href="#cb14-5"></a>buildings <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">file.path</span>(data, <span class="st">"gis_osm_buildings_a_free_1.gpkg"</span>), <span class="at">query =</span> buildings_query, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-6"><a href="#cb14-6"></a></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">#transforming crs to 3083 </span></span>
<span id="cb14-8"><a href="#cb14-8"></a>buildings <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(buildings, <span class="dv">3083</span>)</span>
<span id="cb14-9"><a href="#cb14-9"></a></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co"># plot(buildings)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="find-homes-in-blackout-areas" class="level5">
<h5 class="anchored" data-anchor-id="find-homes-in-blackout-areas">find homes in blackout areas</h5>
<p>I then filtered the mask to homes within blackout areas and counted the number of impacted homes.</p>
<div class="cell">
<details>
<summary>code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co">#subsettign the number of homes experiencing blackouts </span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co">#I am including areas inside of houston that also extend outside of Houston border using st_intersects</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>bo_homes <span class="ot">&lt;-</span> buildings[mask_no_hwy, ]</span>
<span id="cb15-4"><a href="#cb15-4"></a></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co">#counting blackout homes</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>bo_homes_cnt <span class="ot">&lt;-</span> <span class="fu">comma</span>(<span class="fu">nrow</span>(bo_homes))</span>
<span id="cb15-7"><a href="#cb15-7"></a></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="fu">cat</span>(<span class="st">"Number of homes that experienced blackouts during the storm:"</span>, bo_homes_cnt, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Number of homes that experienced blackouts during the storm: 139,148 </code></pre>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="investigate-socioeconomic-factors" class="level4">
<h4 class="anchored" data-anchor-id="investigate-socioeconomic-factors">Investigate socioeconomic factors</h4>
<section id="load-acs-data" class="level5">
<h5 class="anchored" data-anchor-id="load-acs-data">load ACS data</h5>
<p>First, I read in the geodatabase layers using <code>st_read()</code> (geometries are stored in the <code>ACS_2019_5YR_TRACT_48_TEXAS</code> layer and income data is stored in the <code>X19_INCOME</code> layer). For this analysis, I used the median income field <code>B19013e1</code> for income. Data was then reprojected to EPSG:3083.</p>
<div class="cell">
<details>
<summary>code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># reading ACS gdb layers</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="fu">st_layers</span>(<span class="fu">file.path</span>(data, <span class="st">"ACS_2019_5YR_TRACT_48_TEXAS.gdb"</span>))</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co"># reading in geometries layer</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>acs_geoms <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">file.path</span>(data, <span class="st">"ACS_2019_5YR_TRACT_48_TEXAS.gdb"</span>), <span class="at">layer =</span> <span class="st">"ACS_2019_5YR_TRACT_48_TEXAS"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-6"><a href="#cb17-6"></a>  <span class="fu">st_transform</span>(<span class="st">"EPSG:3083"</span>)</span>
<span id="cb17-7"><a href="#cb17-7"></a></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co"># reading in income layer</span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="co">#selecting just GEOID and median income </span></span>
<span id="cb17-10"><a href="#cb17-10"></a>acs_income <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">file.path</span>(data, <span class="st">"ACS_2019_5YR_TRACT_48_TEXAS.gdb"</span>), <span class="at">layer =</span> <span class="st">"X19_INCOME"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-11"><a href="#cb17-11"></a>  <span class="fu">select</span>(<span class="at">GEOID_Data =</span> GEOID, <span class="at">med_income =</span> B19013e1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="determine-which-census-tracts-experienced-blackouts" class="level5">
<h5 class="anchored" data-anchor-id="determine-which-census-tracts-experienced-blackouts">determine which census tracts experienced blackouts</h5>
<p>Next, I joined the income data to the census tract geometries uaing a <code>left_join</code> function by “ID”. This was then spatially joined to the census tract data with buildings determined to be impacted by blackouts using the <code>st_intersects</code> operation. Lastly, census tracts that had blackouts were identified.</p>
<div class="cell">
<details>
<summary>code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co">#finding out how many and which census tracts experienced a blackout</span></span>
<span id="cb18-2"><a href="#cb18-2"></a></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">#joining income data to geometries </span></span>
<span id="cb18-4"><a href="#cb18-4"></a>acs_join <span class="ot">&lt;-</span> <span class="fu">left_join</span>(acs_geoms, acs_income)</span>
<span id="cb18-5"><a href="#cb18-5"></a></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="co"># spatial join census tract data with buildings </span></span>
<span id="cb18-7"><a href="#cb18-7"></a>spat_join <span class="ot">&lt;-</span> acs_join <span class="sc">%&gt;%</span> </span>
<span id="cb18-8"><a href="#cb18-8"></a>   <span class="fu">st_filter</span>(bo_homes, <span class="at">.predicate =</span> st_intersects)</span>
<span id="cb18-9"><a href="#cb18-9"></a></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="co"># length(spat_join)</span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="co"># names(spat_join)</span></span>
<span id="cb18-12"><a href="#cb18-12"></a></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="co">#census tracts that experience a blackout</span></span>
<span id="cb18-14"><a href="#cb18-14"></a>bo_tract_list <span class="ot">&lt;-</span> <span class="fu">unique</span>(spat_join<span class="sc">$</span>NAMELSAD)</span>
<span id="cb18-15"><a href="#cb18-15"></a></span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="co">#count of census tracts that experience a blackout</span></span>
<span id="cb18-17"><a href="#cb18-17"></a>bo_tract_count <span class="ot">&lt;-</span> <span class="fu">length</span>(bo_tract_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="check-3-making-sure-only-census-tracts-with-homes-that-experienced-a-blackout-are-included" class="level5">
<h5 class="anchored" data-anchor-id="check-3-making-sure-only-census-tracts-with-homes-that-experienced-a-blackout-are-included">CHECK #3: making sure only census tracts with homes that experienced a blackout are included:</h5>
<div class="cell">
<details>
<summary>code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="do">### creating a check #####</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="fu">cat</span>(<span class="st">"CHECK #3 - making sure only census tracts with homes that experienced a blackout are included:"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>CHECK #3 - making sure only census tracts with homes that experienced a blackout are included: </code></pre>
</div>
<details>
<summary>code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(acs_join) <span class="sc">&gt;</span> <span class="fu">nrow</span>(spat_join)) {</span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">cat</span>(<span class="st">"Yes, only black out census tracts included."</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb21-3"><a href="#cb21-3"></a>} <span class="cf">else</span> {</span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="fu">cat</span>(<span class="st">"No, filter didn't work"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb21-5"><a href="#cb21-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Yes, only black out census tracts included. </code></pre>
</div>
</div>
</section>
<section id="compare-incomes-of-impacted-tracts-to-unimpacted-tracts" class="level5">
<h5 class="anchored" data-anchor-id="compare-incomes-of-impacted-tracts-to-unimpacted-tracts">compare incomes of impacted tracts to unimpacted tracts</h5>
<p>Finally, I created a map of median income by census tract and designated which tracts experienced blackouts. I then plot the distribution of income in impacted and nonimpacted tracts to visualize what the spread of the community income looked like.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># In this section, I am mapping the median income of affected census tracts from the black out to visually show what the income of affected areas are in Houston</span></span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co">#check census tract crs</span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="fu">st_crs</span>(acs_join)</span>
<span id="cb23-5"><a href="#cb23-5"></a></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="co">#transform Houston polygon crs to match census tract crs</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>hstn_3083 <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(hstn_sf, <span class="dv">3083</span>)</span>
<span id="cb23-8"><a href="#cb23-8"></a></span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="co"># masking census tracts to houston</span></span>
<span id="cb23-10"><a href="#cb23-10"></a>tract_mask <span class="ot">&lt;-</span> acs_join[hstn_3083, ]</span>
<span id="cb23-11"><a href="#cb23-11"></a></span>
<span id="cb23-12"><a href="#cb23-12"></a><span class="co">#making a new column saying whether or not tracts was a black out or not</span></span>
<span id="cb23-13"><a href="#cb23-13"></a>tract_mask <span class="ot">&lt;-</span> tract_mask <span class="sc">%&gt;%</span> </span>
<span id="cb23-14"><a href="#cb23-14"></a>  <span class="fu">mutate</span>(<span class="at">blackout =</span> <span class="fu">ifelse</span>(NAMELSAD <span class="sc">%in%</span> bo_tract_list, <span class="st">"TRUE"</span>, <span class="st">"FALSE"</span>))</span>
<span id="cb23-15"><a href="#cb23-15"></a></span>
<span id="cb23-16"><a href="#cb23-16"></a></span>
<span id="cb23-17"><a href="#cb23-17"></a></span>
<span id="cb23-18"><a href="#cb23-18"></a><span class="co"># mapping median income of census tracts that experienced blackouts</span></span>
<span id="cb23-19"><a href="#cb23-19"></a></span>
<span id="cb23-20"><a href="#cb23-20"></a><span class="co"># getting a polygon of texas </span></span>
<span id="cb23-21"><a href="#cb23-21"></a>texas <span class="ot">&lt;-</span> us_states <span class="sc">%&gt;%</span> </span>
<span id="cb23-22"><a href="#cb23-22"></a>  <span class="fu">filter</span>(NAME <span class="sc">==</span> <span class="st">"Texas"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-23"><a href="#cb23-23"></a>  <span class="fu">st_transform</span>(<span class="dv">3083</span>)</span>
<span id="cb23-24"><a href="#cb23-24"></a></span>
<span id="cb23-25"><a href="#cb23-25"></a><span class="co">#making an inset map of texas with Houston filled in red  </span></span>
<span id="cb23-26"><a href="#cb23-26"></a>inset_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb23-27"><a href="#cb23-27"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> texas) <span class="sc">+</span> </span>
<span id="cb23-28"><a href="#cb23-28"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> hstn_3083, <span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb23-29"><a href="#cb23-29"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb23-30"><a href="#cb23-30"></a>   <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-31"><a href="#cb23-31"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-32"><a href="#cb23-32"></a>  <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-33"><a href="#cb23-33"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span>
<span id="cb23-34"><a href="#cb23-34"></a></span>
<span id="cb23-35"><a href="#cb23-35"></a></span>
<span id="cb23-36"><a href="#cb23-36"></a><span class="co">#creating a main map of census tracts that experienced blackouts by color </span></span>
<span id="cb23-37"><a href="#cb23-37"></a>main_map <span class="ot">&lt;-</span></span>
<span id="cb23-38"><a href="#cb23-38"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb23-39"><a href="#cb23-39"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> tract_mask, <span class="at">color =</span> <span class="st">"lightgrey"</span>) <span class="sc">+</span></span>
<span id="cb23-40"><a href="#cb23-40"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> spat_join, <span class="fu">aes</span>(<span class="at">fill =</span> med_income)) <span class="sc">+</span></span>
<span id="cb23-41"><a href="#cb23-41"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb23-42"><a href="#cb23-42"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Median Income ($)"</span>) <span class="sc">+</span></span>
<span id="cb23-43"><a href="#cb23-43"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-44"><a href="#cb23-44"></a>  <span class="fu">annotation_scale</span>(<span class="at">plot_unit =</span> <span class="st">"m"</span>, <span class="at">location =</span> <span class="st">"bl"</span>) <span class="sc">+</span></span>
<span id="cb23-45"><a href="#cb23-45"></a>  <span class="fu">theme</span>( <span class="at">legend.position=</span> <span class="fu">c</span>(<span class="fl">1.25</span>, .<span class="dv">75</span>),</span>
<span id="cb23-46"><a href="#cb23-46"></a>         <span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,.<span class="dv">5</span>,<span class="dv">1</span>),<span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb23-47"><a href="#cb23-47"></a>  <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">"bl"</span>,</span>
<span id="cb23-48"><a href="#cb23-48"></a>                         <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="fl">0.05</span>, <span class="st">"in"</span>),</span>
<span id="cb23-49"><a href="#cb23-49"></a>                         <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"in"</span>),</span>
<span id="cb23-50"><a href="#cb23-50"></a>                         <span class="at">style =</span> ggspatial<span class="sc">::</span><span class="fu">north_arrow_minimal</span>())</span>
<span id="cb23-51"><a href="#cb23-51"></a></span>
<span id="cb23-52"><a href="#cb23-52"></a><span class="co">#combining main and inset map </span></span>
<span id="cb23-53"><a href="#cb23-53"></a> comb_map <span class="ot">&lt;-</span> main_map <span class="sc">+</span> </span>
<span id="cb23-54"><a href="#cb23-54"></a>    <span class="fu">inset_element</span>(inset_map, <span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">1.4</span>, .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb23-55"><a href="#cb23-55"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb23-56"><a href="#cb23-56"></a> </span>
<span id="cb23-57"><a href="#cb23-57"></a> comb_map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="houston_blackout_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption"><strong>Figure 1. Median income of census tracts in Houston, TX that experienced blackouts in February 2021.</strong> Map <strong>A</strong> shows all census tracts in Houston area, were tracts that experienced a blackout color coded by the median income of houslholds within the tracts. Brighter colored tracts have higher median incomes where darker colored tracts have lower. Map <strong>B</strong> shows an inset map of where Houston is located in the state of Texas.</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
<div class="cell" data-layout-align="center">
<details>
<summary>code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># here I am creating a histogram and box plot to compare the median incomes of affected and unaffected tracts</span></span>
<span id="cb24-2"><a href="#cb24-2"></a></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="co">#first, calculate median of median incomes for both groups </span></span>
<span id="cb24-4"><a href="#cb24-4"></a>meds <span class="ot">&lt;-</span> tract_mask <span class="sc">%&gt;%</span> </span>
<span id="cb24-5"><a href="#cb24-5"></a>  <span class="fu">group_by</span>(blackout) <span class="sc">%&gt;%</span> </span>
<span id="cb24-6"><a href="#cb24-6"></a>  <span class="fu">summarize</span>(<span class="at">med_med_income =</span> <span class="fu">median</span>(med_income, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-7"><a href="#cb24-7"></a>  <span class="fu">st_drop_geometry</span>()</span>
<span id="cb24-8"><a href="#cb24-8"></a></span>
<span id="cb24-9"><a href="#cb24-9"></a></span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="co">#creating a histogram of income distribution </span></span>
<span id="cb24-11"><a href="#cb24-11"></a>hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tract_mask, <span class="fu">aes</span>(<span class="at">x =</span> med_income, <span class="at">fill =</span> blackout)) <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">65</span>) <span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Median income ($)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb24-14"><a href="#cb24-14"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-15"><a href="#cb24-15"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb24-16"><a href="#cb24-16"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> meds, <span class="fu">aes</span>(<span class="at">x =</span> med_med_income, <span class="at">xend =</span> med_med_income, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">80</span>, <span class="at">color =</span> blackout), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb24-17"><a href="#cb24-17"></a>  <span class="co"># geom_vline(data = meds, aes(xintercept = med_med_income, color = blackout), linetype = "dashed") +</span></span>
<span id="cb24-18"><a href="#cb24-18"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>( <span class="st">"lightblue"</span>, <span class="st">"orange"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No blackouts"</span>, <span class="st">"Blackouts"</span> )) <span class="sc">+</span></span>
<span id="cb24-19"><a href="#cb24-19"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Median"</span>, <span class="at">values =</span> <span class="fu">c</span>( <span class="st">"blue"</span>, <span class="st">"orange3"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No blackouts"</span>, <span class="st">"Blackouts"</span> )) </span>
<span id="cb24-20"><a href="#cb24-20"></a>  <span class="co"># coord_cartesian(ylim = c(0, 75))</span></span>
<span id="cb24-21"><a href="#cb24-21"></a>  </span>
<span id="cb24-22"><a href="#cb24-22"></a>  </span>
<span id="cb24-23"><a href="#cb24-23"></a><span class="co">#creating a boxplot of median income distribution </span></span>
<span id="cb24-24"><a href="#cb24-24"></a>box_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tract_mask, <span class="fu">aes</span>(<span class="at">x =</span> blackout, <span class="at">y =</span> med_income, <span class="at">fill =</span> blackout)) <span class="sc">+</span></span>
<span id="cb24-25"><a href="#cb24-25"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb24-26"><a href="#cb24-26"></a>  <span class="co"># geom_jitter(width = 0.2, alpha = 0.5, color = "grey") +  </span></span>
<span id="cb24-27"><a href="#cb24-27"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Median Income ($)"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb24-28"><a href="#cb24-28"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-29"><a href="#cb24-29"></a>  <span class="fu">scale_fill_manual</span>( <span class="at">name =</span> <span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>( <span class="st">"lightblue"</span>, <span class="st">"orange"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No blackouts"</span>, <span class="st">"Blackouts"</span>)) <span class="sc">+</span></span>
<span id="cb24-30"><a href="#cb24-30"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"No blackouts"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"Blackouts"</span>)) </span>
<span id="cb24-31"><a href="#cb24-31"></a></span>
<span id="cb24-32"><a href="#cb24-32"></a></span>
<span id="cb24-33"><a href="#cb24-33"></a><span class="co">#adding up plots into one using patchwork</span></span>
<span id="cb24-34"><a href="#cb24-34"></a>patched <span class="ot">&lt;-</span> hist <span class="sc">+</span> box_p <span class="sc">+</span> </span>
<span id="cb24-35"><a href="#cb24-35"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>) <span class="sc">+</span></span>
<span id="cb24-36"><a href="#cb24-36"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">&amp;</span></span>
<span id="cb24-37"><a href="#cb24-37"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb24-38"><a href="#cb24-38"></a></span>
<span id="cb24-39"><a href="#cb24-39"></a>patched</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="houston_blackout_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption"><strong>Figure 2. Median houshold income distribution of census tracts in blackout vs non-blackout areas in Houston, 2021.</strong> The first plot <strong>A</strong> shows a histogram of the distribution of median income in both groups of tracts. The frequency is concentrated just under $50,000 for both groups. Data is abnormally distributed with a long right tail, indiating most housholds are lower income with some higher income households drawing the tail right. Plot <strong>B</strong> shows a whisker plot of median distribution. Boxes represent the inter quartile range (IQR, 50% of the data), and the line inside each box represents the median. The whiskers represent 1.5 times the length of the IQR, with some outliers falling above the whiskers.</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>Overall, these results show that census tracts had a similar median income distribution regardless of whether or not they experienced a black out in the February 2021 storm, but income was slightly higher for tracts that experienced a blackout than those that did not. The median of the census tract median income distribution was $57,002 for non-blackout tracts and $60,642 for blackout tracts. The majority of the income distribution is centered at about $35,000 - $45,000, with some outliers in the $200,000 + range. Some of the limitations of the study are that the census tracts don’t represent how many homes experienced a black out or how long the black out was experienced for. These factors could have underlying socioeconomic patterns that we can’t see here which could explain why certain tracts experienced blackouts for the duration that they did. This should be an area for fututre investigation to strengthen the results found in this study.</p>


<!-- -->

</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>LaJoie, A. S., Sprang, G., &amp; McKinney, W. P. (2010). Long‐term effects of Hurricane Katrina on the psychological well‐being of evacuees. Disasters, 34(4), 1031-1044.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Hess, D. B. (2005). Access to employment for adults in poverty in the Buffalo-Niagara region. Urban Studies, 42(7), 1177-1200.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Hess, D. B. (2005). Access to employment for adults in poverty in the Buffalo-Niagara region. Urban Studies, 42(7), 1177-1200.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Li, Z., Li, X., Wang, Y., &amp; Quiring, S. M. (2019). Impact of climate change on precipitation patterns in Houston, Texas, USA. Anthropocene, 25, 100193.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb25" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb25-1"><a href="#cb25-1"></a><span class="co">---</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="an">title:</span><span class="co"> "A Spatial Analysis of Houston Blackouts and the Communities it Affected"</span></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="an">description:</span><span class="co"> "an investigation of environmental injustice"</span></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="an">author:</span></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="co">  - name: Raymond Hunter</span></span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="co">    url: https://ramhunte.github.io/</span></span>
<span id="cb25-7"><a href="#cb25-7"></a><span class="an">date:</span><span class="co"> 12-015-2023</span></span>
<span id="cb25-8"><a href="#cb25-8"></a><span class="co"># bibliography: references.bib</span></span>
<span id="cb25-9"><a href="#cb25-9"></a><span class="co">#citation:</span></span>
<span id="cb25-10"><a href="#cb25-10"></a><span class="co">  # url:</span></span>
<span id="cb25-11"><a href="#cb25-11"></a><span class="co"># image: </span></span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="an">categories:</span><span class="co"> [Quarto, R] # self-defined categories</span></span>
<span id="cb25-13"><a href="#cb25-13"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb25-14"><a href="#cb25-14"></a><span class="co">  html:</span></span>
<span id="cb25-15"><a href="#cb25-15"></a><span class="co">    code-fold: true</span></span>
<span id="cb25-16"><a href="#cb25-16"></a><span class="co">    code-copy: true</span></span>
<span id="cb25-17"><a href="#cb25-17"></a><span class="co">    code-summary: "code"</span></span>
<span id="cb25-18"><a href="#cb25-18"></a><span class="co">    code-line-numbers: true</span></span>
<span id="cb25-19"><a href="#cb25-19"></a><span class="co">    code-tools: true</span></span>
<span id="cb25-20"><a href="#cb25-20"></a><span class="co">    code-block-border-left: true</span></span>
<span id="cb25-21"><a href="#cb25-21"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb25-22"><a href="#cb25-22"></a><span class="an">draft:</span><span class="co"> false # setting this to `true` will prevent your post from appearing on your listing page until you're ready!</span></span>
<span id="cb25-23"><a href="#cb25-23"></a><span class="co">---</span></span>
<span id="cb25-24"><a href="#cb25-24"></a></span>
<span id="cb25-25"><a href="#cb25-25"></a><span class="co">[</span><span class="ot">Github project repository</span><span class="co">](https://github.com/ramhunte/houston_blackout)</span></span>
<span id="cb25-26"><a href="#cb25-26"></a></span>
<span id="cb25-27"><a href="#cb25-27"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb25-28"><a href="#cb25-28"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">message =</span> <span class="cn">FALSE</span>, <span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">results =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-29"><a href="#cb25-29"></a></span>
<span id="cb25-30"><a href="#cb25-30"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb25-31"><a href="#cb25-31"></a><span class="fu">library</span>(ggspatial)</span>
<span id="cb25-32"><a href="#cb25-32"></a><span class="fu">library</span>(sf)</span>
<span id="cb25-33"><a href="#cb25-33"></a><span class="fu">library</span>(stars)</span>
<span id="cb25-34"><a href="#cb25-34"></a><span class="fu">library</span>(spDataLarge)</span>
<span id="cb25-35"><a href="#cb25-35"></a><span class="fu">library</span>(spData)</span>
<span id="cb25-36"><a href="#cb25-36"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb25-37"><a href="#cb25-37"></a><span class="fu">library</span>(scales)</span>
<span id="cb25-38"><a href="#cb25-38"></a></span>
<span id="cb25-39"><a href="#cb25-39"></a><span class="co"># Setting my filepaths</span></span>
<span id="cb25-40"><a href="#cb25-40"></a>rootdir <span class="ot">&lt;-</span> (<span class="st">"/Users/rayhunter/Documents/Bren/Past_Courses/EDS_223/assignments/assignment-3-ramhunte"</span>)</span>
<span id="cb25-41"><a href="#cb25-41"></a>data <span class="ot">&lt;-</span> <span class="fu">file.path</span>(rootdir,<span class="st">"data"</span>)</span>
<span id="cb25-42"><a href="#cb25-42"></a></span>
<span id="cb25-43"><a href="#cb25-43"></a><span class="in">```</span></span>
<span id="cb25-44"><a href="#cb25-44"></a></span>
<span id="cb25-45"><a href="#cb25-45"></a><span class="fu">## Background</span></span>
<span id="cb25-46"><a href="#cb25-46"></a></span>
<span id="cb25-47"><a href="#cb25-47"></a>Natural disasters oftentimes occur unpredictably and rapidly, and the severity of them can vary widely. Specifically in the Southern United States, major storms (like Hurricane Katrina) can have devastating and long lasting consequences on communities.<span class="ot">[^1]</span> "In February 2021, the state of Texas suffered a major power crisis, which came about as a result of three severe winter storms sweeping across the United States on February 10--11, 13--17, and 15--20."<span class="ot">[^2]</span>. While these storms seem like once in a blue moon events, they are becoming much more of a normal occurrence. More importantly, storms do not impact all communities the same, and therefore it is critical that we incorporate racial justice components to our lines of environmental analysese to understand how we can mitigate marginalized groups from being disproportianately harmed from climate change.</span>
<span id="cb25-48"><a href="#cb25-48"></a></span>
<span id="cb25-49"><a href="#cb25-49"></a><span class="ot">[^1]</span>:LaJoie, A. S., Sprang, G., &amp; McKinney, W. P. (2010). Long‐term effects of Hurricane Katrina on the psychological well‐being of evacuees. Disasters, 34(4), 1031-1044.</span>
<span id="cb25-50"><a href="#cb25-50"></a></span>
<span id="cb25-51"><a href="#cb25-51"></a><span class="ot">[^2]: </span>Wikipedia. 2021. "2021 Texas power crisis." Last modified October</span>
<span id="cb25-52"><a href="#cb25-52"></a>    2, 2021. <span class="ot">&lt;https://en.wikipedia.org/wiki/2021_Texas_power_crisis&gt;</span>.</span>
<span id="cb25-53"><a href="#cb25-53"></a></span>
<span id="cb25-54"><a href="#cb25-54"></a><span class="fu">## Goal </span></span>
<span id="cb25-55"><a href="#cb25-55"></a>The goal of this study is to try and answer the question: **Which communities in Houston experienced blackouts from the February 2021 storms, and did they vary by socioeconomic status?** Other studies have shown that not only do lower socioeconomic status communities experience more intense consequences of natural disaster, but they also don't always receive the same degree of aid following one.<span class="ot">[^2]</span></span>
<span id="cb25-56"><a href="#cb25-56"></a></span>
<span id="cb25-57"><a href="#cb25-57"></a><span class="ot">[^2]: </span>Hess, D. B. (2005). Access to employment for adults in poverty in the Buffalo-Niagara region. Urban Studies, 42(7), 1177-1200.</span>
<span id="cb25-58"><a href="#cb25-58"></a></span>
<span id="cb25-59"><a href="#cb25-59"></a>By identifying the total number of houses in Houston that lost power and overlaying socioeconomic data to these homes, we can begin to look at these underlying patterns of potential environmental injustice. These types of studies are becoming critically important as climate change continues to increase the frequency of severe storms including intense precipitation events throughout Texas<span class="ot">[^3]</span> as not all communities are affected the same. We need to look at how communities of varying socioeconomic status are impacted as a result.</span>
<span id="cb25-60"><a href="#cb25-60"></a></span>
<span id="cb25-61"><a href="#cb25-61"></a><span class="ot">[^3]: </span>Li, Z., Li, X., Wang, Y., &amp; Quiring, S. M. (2019). Impact of climate change on precipitation patterns in Houston, Texas, USA. Anthropocene, 25, 100193.</span>
<span id="cb25-62"><a href="#cb25-62"></a></span>
<span id="cb25-63"><a href="#cb25-63"></a><span class="fu">## Approach</span></span>
<span id="cb25-64"><a href="#cb25-64"></a></span>
<span id="cb25-65"><a href="#cb25-65"></a>I used remotely-sensed night lights data from before and after the storms to estimate power outages. Data was acquired from the [Visible Infrared Imaging Radiometer Suite</span>
<span id="cb25-66"><a href="#cb25-66"></a>(VIIRS)](https://en.wikipedia.org/wiki/Visible_Infrared_Imaging_Radiometer_Suite)</span>
<span id="cb25-67"><a href="#cb25-67"></a>from the Suomi satellite. I used the VNP46A1 tolook for variation in night lights before and after the storm as a way of identifying areas that lost electric power as a result of the storms. Furthermore, data containing the physical boundaires and area of buildings and roads is needed to spatially join to areas that lost power. I gathered this data from <span class="co">[</span><span class="ot">OpenStreetMap</span><span class="co">](https://www.openstreetmap.org/#map=4/38.01/-95.84)</span> providing high resolution data on the structural layout of the city. Finally, we need to join this data with socioeconomic factor data pertaining to all the communities in Houston affected by the blackouts. I pulled this data from the US Census Bureau (see <span class="in">`Readme`</span> file) that shows block group county level information on various socioeconomic characterisitcs.</span>
<span id="cb25-68"><a href="#cb25-68"></a></span>
<span id="cb25-69"><a href="#cb25-69"></a>These types of analysis require a variety of different tools to carry out from satellite images and census data to finalized maps. Some of the most important tools in carrying out this analysis include:</span>
<span id="cb25-70"><a href="#cb25-70"></a><span class="ss">* </span>loading, transforming, and wrangling vector/raster data</span>
<span id="cb25-71"><a href="#cb25-71"></a><span class="ss">* </span>raster operations to identify blackout areas from satellite imagery</span>
<span id="cb25-72"><a href="#cb25-72"></a><span class="ss">* </span>vector operations to isolate affected buildings and remove interference (road lights)</span>
<span id="cb25-73"><a href="#cb25-73"></a><span class="ss">* </span>spatial joins of regions experiencing blackouts and the total number of untis within them</span>
<span id="cb25-74"><a href="#cb25-74"></a></span>
<span id="cb25-75"><a href="#cb25-75"></a><span class="fu">### Data</span></span>
<span id="cb25-76"><a href="#cb25-76"></a></span>
<span id="cb25-77"><a href="#cb25-77"></a><span class="fu">#### Night lights</span></span>
<span id="cb25-78"><a href="#cb25-78"></a></span>
<span id="cb25-79"><a href="#cb25-79"></a>Using NASA's Worldview to find data pre and post storm, I found satellite images recorded on</span>
<span id="cb25-80"><a href="#cb25-80"></a>2021-02-07 and 2021-02-16 that provided two clear, contrasting images to</span>
<span id="cb25-81"><a href="#cb25-81"></a>visualize the extent of the power outage in Texas.</span>
<span id="cb25-82"><a href="#cb25-82"></a>VIIRS data is distributed through NASA's <span class="co">[</span><span class="ot">Level-1 and Atmospheric Archive &amp; Distribution System Distributed Active Archive Center (LAADS DAAC)</span><span class="co">](https://ladsweb.modaps.eosdis.nasa.gov/)</span>. Many NASA Earth data</span>
<span id="cb25-83"><a href="#cb25-83"></a>products are distributed in 10x10 degree tiles in sinusoidal equal-area</span>
<span id="cb25-84"><a href="#cb25-84"></a>projection that are identified by their horizontal and vertical</span>
<span id="cb25-85"><a href="#cb25-85"></a>position in the grid. Houston lies on the border of tiles h08v05 and</span>
<span id="cb25-86"><a href="#cb25-86"></a>h08v06, and so I downloaded two tiles per date to ensure the whole city was being included.</span>
<span id="cb25-87"><a href="#cb25-87"></a>These data are stored in the <span class="in">`VNP46A1`</span> folder:</span>
<span id="cb25-88"><a href="#cb25-88"></a></span>
<span id="cb25-89"><a href="#cb25-89"></a><span class="ss">-   </span><span class="in">`VNP46A1.A2021038.h08v05.001.2021039064328.h5.tif`</span>: tile h08v05,</span>
<span id="cb25-90"><a href="#cb25-90"></a>    collected on 2021-02-07\</span>
<span id="cb25-91"><a href="#cb25-91"></a><span class="ss">-   </span><span class="in">`VNP46A1.A2021038.h08v06.001.2021039064329.h5.tif`</span>: tile h08v06,</span>
<span id="cb25-92"><a href="#cb25-92"></a>    collected on 2021-02-07\</span>
<span id="cb25-93"><a href="#cb25-93"></a><span class="ss">-   </span><span class="in">`VNP46A1.A2021047.h08v05.001.2021048091106.h5.tif`</span>: tile h08v05,</span>
<span id="cb25-94"><a href="#cb25-94"></a>    collected on 2021-02-16\</span>
<span id="cb25-95"><a href="#cb25-95"></a><span class="ss">-   </span><span class="in">`VNP46A1.A2021047.h08v06.001.2021048091105.h5.tif`</span>: tile h08v06,</span>
<span id="cb25-96"><a href="#cb25-96"></a>    collected on 2021-02-16</span>
<span id="cb25-97"><a href="#cb25-97"></a></span>
<span id="cb25-98"><a href="#cb25-98"></a><span class="fu">#### Roads</span></span>
<span id="cb25-99"><a href="#cb25-99"></a></span>
<span id="cb25-100"><a href="#cb25-100"></a>One issue with night light data is that light pollution can interfere with detecting patterns of interest. Highways make up much of the night lights seen from space (see Google's <span class="co">[</span><span class="ot">Earth at Night</span><span class="co">](https://earth.google.com/web/@27.44405464,-84.7693044,206.63660162a,8916361.52264659d,35y,0h,0t,0r/data=CiQSIhIgMGY3ZTJkYzdlOGExMTFlNjk5MGQ2ZjgxOGQ2OWE2ZTc)</span>).</span>
<span id="cb25-101"><a href="#cb25-101"></a>Therefore, it is important to minimize falsely identifying areas with reduced traffic as areas</span>
<span id="cb25-102"><a href="#cb25-102"></a>without power.</span>
<span id="cb25-103"><a href="#cb25-103"></a><span class="co">[</span><span class="ot">OpenStreetMap (OSM)</span><span class="co">](https://planet.openstreetmap.org/)</span> is a</span>
<span id="cb25-104"><a href="#cb25-104"></a>collaborative project which creates publicly available geographic data</span>
<span id="cb25-105"><a href="#cb25-105"></a>of the world. I used [Geofabrik's download</span>
<span id="cb25-106"><a href="#cb25-106"></a>sites](https://download.geofabrik.de/) to retrieve a shapefile of all</span>
<span id="cb25-107"><a href="#cb25-107"></a>highways in Texas and prepared a Geopackage (<span class="in">`.gpkg`</span> file) containing</span>
<span id="cb25-108"><a href="#cb25-108"></a>just the subset of roads that intersect the Houston metropolitan area.</span>
<span id="cb25-109"><a href="#cb25-109"></a></span>
<span id="cb25-110"><a href="#cb25-110"></a><span class="ss">-   </span><span class="in">`gis_osm_roads_free_1.gpkg`</span></span>
<span id="cb25-111"><a href="#cb25-111"></a></span>
<span id="cb25-112"><a href="#cb25-112"></a><span class="fu">#### Houses</span></span>
<span id="cb25-113"><a href="#cb25-113"></a></span>
<span id="cb25-114"><a href="#cb25-114"></a>I also obtained building data from OpenStreetMap. Again, I downloaded</span>
<span id="cb25-115"><a href="#cb25-115"></a>from Geofabrick and prepared a GeoPackage containing only houses in the</span>
<span id="cb25-116"><a href="#cb25-116"></a>Houston metropolitan area.\</span>
<span id="cb25-117"><a href="#cb25-117"></a></span>
<span id="cb25-118"><a href="#cb25-118"></a><span class="ss">-   </span><span class="in">`gis_osm_buildings_a_free_1.gpkg`</span></span>
<span id="cb25-119"><a href="#cb25-119"></a></span>
<span id="cb25-120"><a href="#cb25-120"></a><span class="fu">#### Socioeconomic</span></span>
<span id="cb25-121"><a href="#cb25-121"></a></span>
<span id="cb25-122"><a href="#cb25-122"></a>I used data from the [U.S. Census Bureau's American</span>
<span id="cb25-123"><a href="#cb25-123"></a>Community Survey](https://www.census.gov/programs-surveys/acs) for</span>
<span id="cb25-124"><a href="#cb25-124"></a>census tracts in 2019 to reoresent socioeconomic data of different regions of Houston. The *folder* <span class="in">`ACS_2019_5YR_TRACT_48.gdb`</span> is an</span>
<span id="cb25-125"><a href="#cb25-125"></a>ArcGIS ["file</span>
<span id="cb25-126"><a href="#cb25-126"></a>geodatabase"](https://desktop.arcgis.com/en/arcmap/latest/manage-data/administer-file-gdbs/file-geodatabases.htm),</span>
<span id="cb25-127"><a href="#cb25-127"></a>a multi-file proprietary format that's roughly analogous to a GeoPackage</span>
<span id="cb25-128"><a href="#cb25-128"></a>file.</span>
<span id="cb25-129"><a href="#cb25-129"></a>Each layer contains a subset of the fields documents in the [ACS</span>
<span id="cb25-130"><a href="#cb25-130"></a>metadata](https://www2.census.gov/geo/docs/maps-data/data/tiger/prejoined/ACSMetadata2011.txt).</span>
<span id="cb25-131"><a href="#cb25-131"></a>The geodatabase contains a layer holding the geometry information,</span>
<span id="cb25-132"><a href="#cb25-132"></a>separate from the layers holding the ACS attributes. You have to combine</span>
<span id="cb25-133"><a href="#cb25-133"></a>the geometry with the attributes to get a feature layer that <span class="in">`sf`</span> can</span>
<span id="cb25-134"><a href="#cb25-134"></a>use.</span>
<span id="cb25-135"><a href="#cb25-135"></a></span>
<span id="cb25-136"><a href="#cb25-136"></a></span>
<span id="cb25-137"><a href="#cb25-137"></a><span class="fu">## Analysis</span></span>
<span id="cb25-138"><a href="#cb25-138"></a></span>
<span id="cb25-139"><a href="#cb25-139"></a><span class="fu">#### Find locations of blackouts</span></span>
<span id="cb25-140"><a href="#cb25-140"></a></span>
<span id="cb25-141"><a href="#cb25-141"></a><span class="fu">##### combine the data </span></span>
<span id="cb25-142"><a href="#cb25-142"></a></span>
<span id="cb25-143"><a href="#cb25-143"></a>First, I read in the night lights tiles data and combining them into a single <span class="in">`stars`</span> object for each date (2021-02-07 and 2021-02-16).</span>
<span id="cb25-144"><a href="#cb25-144"></a></span>
<span id="cb25-147"><a href="#cb25-147"></a><span class="in">```{r}</span></span>
<span id="cb25-148"><a href="#cb25-148"></a><span class="co">#reading in raster data </span></span>
<span id="cb25-149"><a href="#cb25-149"></a>t1 <span class="ot">=</span> <span class="fu">read_stars</span>(<span class="fu">file.path</span>(data, <span class="st">"VNP46A1/VNP46A1.A2021038.h08v05.001.2021039064328.tif"</span>))</span>
<span id="cb25-150"><a href="#cb25-150"></a>t2 <span class="ot">=</span> <span class="fu">read_stars</span>(<span class="fu">file.path</span>(data,<span class="st">"VNP46A1/VNP46A1.A2021038.h08v06.001.2021039064329.tif"</span>))</span>
<span id="cb25-151"><a href="#cb25-151"></a>t3 <span class="ot">=</span> <span class="fu">read_stars</span>(<span class="fu">file.path</span>(data,<span class="st">"VNP46A1/VNP46A1.A2021047.h08v05.001.2021048091106.tif"</span>))</span>
<span id="cb25-152"><a href="#cb25-152"></a>t4 <span class="ot">=</span> <span class="fu">read_stars</span>(<span class="fu">file.path</span>(data,<span class="st">"VNP46A1/VNP46A1.A2021047.h08v06.001.2021048091105.tif"</span>))</span>
<span id="cb25-153"><a href="#cb25-153"></a></span>
<span id="cb25-154"><a href="#cb25-154"></a><span class="co">#creating a mosaic of houston raster data for both days </span></span>
<span id="cb25-155"><a href="#cb25-155"></a>lights_mos1 <span class="ot">&lt;-</span> <span class="fu">st_mosaic</span>(t1, t2)</span>
<span id="cb25-156"><a href="#cb25-156"></a>lights_mos2 <span class="ot">&lt;-</span> <span class="fu">st_mosaic</span>(t3, t4)</span>
<span id="cb25-157"><a href="#cb25-157"></a></span>
<span id="cb25-158"><a href="#cb25-158"></a><span class="co"># plot(lights_mos1)</span></span>
<span id="cb25-159"><a href="#cb25-159"></a><span class="in">```</span></span>
<span id="cb25-160"><a href="#cb25-160"></a></span>
<span id="cb25-161"><a href="#cb25-161"></a><span class="fu">##### create a blackout mask</span></span>
<span id="cb25-162"><a href="#cb25-162"></a></span>
<span id="cb25-163"><a href="#cb25-163"></a>I then found the change in night lights intensity (presumably) caused by the</span>
<span id="cb25-164"><a href="#cb25-164"></a>storm. I first reclassified a difference raster, assuming that any location that experienced a drop of more than 200 nW cm^-2^sr^-1^ experienced a blackout. <span class="in">`NA`</span> values were to all locations that experienced a drop of *less* than 200 nW cm^-2^sr^-1^.</span>
<span id="cb25-165"><a href="#cb25-165"></a></span>
<span id="cb25-168"><a href="#cb25-168"></a><span class="in">```{r}</span></span>
<span id="cb25-169"><a href="#cb25-169"></a><span class="co">#finding difference in light intensity by subtracting light difference </span></span>
<span id="cb25-170"><a href="#cb25-170"></a>light_diff <span class="ot">&lt;-</span> lights_mos1 <span class="sc">-</span> lights_mos2</span>
<span id="cb25-171"><a href="#cb25-171"></a></span>
<span id="cb25-172"><a href="#cb25-172"></a><span class="co"># plot(light_diff)</span></span>
<span id="cb25-173"><a href="#cb25-173"></a></span>
<span id="cb25-174"><a href="#cb25-174"></a><span class="co">#reclassify raster to give NA values to locations that did not experience a blackout</span></span>
<span id="cb25-175"><a href="#cb25-175"></a>light_diff[light_diff <span class="sc">&lt;</span> <span class="dv">200</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb25-176"><a href="#cb25-176"></a></span>
<span id="cb25-177"><a href="#cb25-177"></a><span class="co"># plot(light_diff)</span></span>
<span id="cb25-178"><a href="#cb25-178"></a></span>
<span id="cb25-179"><a href="#cb25-179"></a><span class="in">```</span></span>
<span id="cb25-180"><a href="#cb25-180"></a></span>
<span id="cb25-181"><a href="#cb25-181"></a><span class="fu">##### vectorize the mask </span></span>
<span id="cb25-182"><a href="#cb25-182"></a></span>
<span id="cb25-183"><a href="#cb25-183"></a>I vectorized the the blackout mask and fixed any invalid geometries using <span class="in">`st_make_valid`</span>. I then inspected it to make sure it was an sf object and to look at its characteristics.</span>
<span id="cb25-184"><a href="#cb25-184"></a></span>
<span id="cb25-187"><a href="#cb25-187"></a><span class="in">```{r}</span></span>
<span id="cb25-188"><a href="#cb25-188"></a><span class="co">#creating a black out mask as a sf object. This creates a mask of geometries that experienced a black out</span></span>
<span id="cb25-189"><a href="#cb25-189"></a>bo_mask <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(light_diff)</span>
<span id="cb25-190"><a href="#cb25-190"></a></span>
<span id="cb25-191"><a href="#cb25-191"></a><span class="co">#making sure geometries are valid</span></span>
<span id="cb25-192"><a href="#cb25-192"></a><span class="fu">st_make_valid</span>(bo_mask)</span>
<span id="cb25-193"><a href="#cb25-193"></a></span>
<span id="cb25-194"><a href="#cb25-194"></a><span class="co">#making sure new object is an sf and inspecting it</span></span>
<span id="cb25-195"><a href="#cb25-195"></a><span class="fu">class</span>(bo_mask)</span>
<span id="cb25-196"><a href="#cb25-196"></a><span class="co"># plot(bo_mask)</span></span>
<span id="cb25-197"><a href="#cb25-197"></a><span class="fu">summary</span>(bo_mask)</span>
<span id="cb25-198"><a href="#cb25-198"></a><span class="in">```</span></span>
<span id="cb25-199"><a href="#cb25-199"></a></span>
<span id="cb25-200"><a href="#cb25-200"></a><span class="fu">##### crop the vectorized map to Houston</span></span>
<span id="cb25-201"><a href="#cb25-201"></a></span>
<span id="cb25-202"><a href="#cb25-202"></a>I defined the Houston metropolitan area with the following coordinates: (-96.5, 29), (-96.5, 30.5), (-94.5, 30.5), (-94.5, 29) and then turned them into a polygon using <span class="in">`st_polygon`</span>. A CRS was then added to the polygon to make a simple features collection using <span class="in">`st_sfc()`</span>. Lastly, I cropped (spatially subset) the blackout mask to our region of interest and re-project the cropped blackout dataset to EPSG:3083 (NAD83 / Texas Centric Albers Equal Area).</span>
<span id="cb25-203"><a href="#cb25-203"></a></span>
<span id="cb25-206"><a href="#cb25-206"></a><span class="in">```{r}</span></span>
<span id="cb25-207"><a href="#cb25-207"></a><span class="co">#creating a matrix of coordinates for houston</span></span>
<span id="cb25-208"><a href="#cb25-208"></a><span class="co">#note: last coordinate need to be same as the first</span></span>
<span id="cb25-209"><a href="#cb25-209"></a>hstn_cords <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">96.5</span>, <span class="dv">29</span>, <span class="sc">-</span><span class="fl">96.5</span>, <span class="fl">30.5</span>, <span class="sc">-</span><span class="fl">94.5</span>, <span class="fl">30.5</span>, <span class="sc">-</span><span class="fl">94.5</span>, <span class="dv">29</span>, <span class="sc">-</span><span class="fl">96.5</span>, <span class="dv">29</span>), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-210"><a href="#cb25-210"></a></span>
<span id="cb25-211"><a href="#cb25-211"></a><span class="co">#creating a polygon for houston </span></span>
<span id="cb25-212"><a href="#cb25-212"></a>hstn_poly <span class="ot">&lt;-</span> <span class="fu">st_polygon</span>(<span class="fu">list</span>(hstn_cords))</span>
<span id="cb25-213"><a href="#cb25-213"></a></span>
<span id="cb25-214"><a href="#cb25-214"></a><span class="fu">class</span>(hstn_poly)</span>
<span id="cb25-215"><a href="#cb25-215"></a></span>
<span id="cb25-216"><a href="#cb25-216"></a><span class="co">#making a simple feature collection using same crs as bo_mask</span></span>
<span id="cb25-217"><a href="#cb25-217"></a>hstn_sf <span class="ot">&lt;-</span> <span class="fu">st_sfc</span>(hstn_poly, <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb25-218"><a href="#cb25-218"></a></span>
<span id="cb25-219"><a href="#cb25-219"></a><span class="fu">class</span>(hstn_sf)</span>
<span id="cb25-220"><a href="#cb25-220"></a></span>
<span id="cb25-221"><a href="#cb25-221"></a><span class="co">#cropping black out mask to the houston sf object </span></span>
<span id="cb25-222"><a href="#cb25-222"></a>bo_mask_houst <span class="ot">&lt;-</span> bo_mask[hstn_sf, ] </span>
<span id="cb25-223"><a href="#cb25-223"></a></span>
<span id="cb25-224"><a href="#cb25-224"></a><span class="co">#transforming crs to EPSG:3083 </span></span>
<span id="cb25-225"><a href="#cb25-225"></a>bo_mask_houst <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(bo_mask_houst, <span class="dv">3083</span>)</span>
<span id="cb25-226"><a href="#cb25-226"></a><span class="in">```</span></span>
<span id="cb25-227"><a href="#cb25-227"></a></span>
<span id="cb25-228"><a href="#cb25-228"></a><span class="fu">##### Check #1: Ensurign that the mask function worked</span></span>
<span id="cb25-229"><a href="#cb25-229"></a><span class="in">```{r, results = TRUE}</span></span>
<span id="cb25-230"><a href="#cb25-230"></a><span class="do">##### creating a check ######</span></span>
<span id="cb25-231"><a href="#cb25-231"></a></span>
<span id="cb25-232"><a href="#cb25-232"></a><span class="fu">cat</span>(<span class="st">"CHECK #1 - see if raster data is masked within Houston:"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb25-233"><a href="#cb25-233"></a></span>
<span id="cb25-234"><a href="#cb25-234"></a><span class="cf">if</span>(<span class="fu">nrow</span>(bo_mask_houst) <span class="sc">==</span> <span class="fu">nrow</span>(bo_mask)) {</span>
<span id="cb25-235"><a href="#cb25-235"></a>  <span class="fu">cat</span>(<span class="st">"No: mask did not work."</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb25-236"><a href="#cb25-236"></a>} <span class="cf">else</span> {</span>
<span id="cb25-237"><a href="#cb25-237"></a>  <span class="fu">cat</span>(<span class="st">" Yes, all black out raster data lie within the Houston polygon."</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb25-238"><a href="#cb25-238"></a>}</span>
<span id="cb25-239"><a href="#cb25-239"></a></span>
<span id="cb25-240"><a href="#cb25-240"></a><span class="in">```</span></span>
<span id="cb25-241"><a href="#cb25-241"></a></span>
<span id="cb25-242"><a href="#cb25-242"></a><span class="kw">&lt;/br&gt;</span> </span>
<span id="cb25-243"><a href="#cb25-243"></a><span class="kw">&lt;/br&gt;</span></span>
<span id="cb25-244"><a href="#cb25-244"></a></span>
<span id="cb25-245"><a href="#cb25-245"></a><span class="fu">##### exclude highways from blackout mask </span></span>
<span id="cb25-246"><a href="#cb25-246"></a></span>
<span id="cb25-247"><a href="#cb25-247"></a>The roads geopackage provoded includes data on roads other than highways.</span>
<span id="cb25-248"><a href="#cb25-248"></a>However, we can avoid reading in data we don't need by taking advantage</span>
<span id="cb25-249"><a href="#cb25-249"></a>of <span class="in">`st_read`</span>'s ability to subset using a SQL query. This allows us to save comutational energy by just pulling in relevant data we want.</span>
<span id="cb25-250"><a href="#cb25-250"></a></span>
<span id="cb25-251"><a href="#cb25-251"></a>First I defined a SQL query:</span>
<span id="cb25-252"><a href="#cb25-252"></a></span>
<span id="cb25-253"><a href="#cb25-253"></a><span class="in">`query &lt;- "SELECT * FROM gis_osm_roads_free_1 WHERE fclass='motorway'"`</span></span>
<span id="cb25-254"><a href="#cb25-254"></a></span>
<span id="cb25-255"><a href="#cb25-255"></a>I applied to <span class="in">`st_read`</span> to load just highway data from geopackage. I then reprojected the data to EPSG:3083 and identified areas within 200m of all highways using <span class="in">`st_buffer`</span> and dissolved them with <span class="in">`st_union`</span>. Lastly, I find areas that experienced blackouts that are further than 200m from a highway through spatial subsetting using the <span class="in">`st_disjoint`</span> operation.</span>
<span id="cb25-256"><a href="#cb25-256"></a></span>
<span id="cb25-257"><a href="#cb25-257"></a></span>
<span id="cb25-258"><a href="#cb25-258"></a><span class="in">```{r, results= TRUE}</span></span>
<span id="cb25-259"><a href="#cb25-259"></a><span class="co">#assigning a query that pulls highway roads</span></span>
<span id="cb25-260"><a href="#cb25-260"></a>highway_query <span class="ot">&lt;-</span> <span class="st">"SELECT * FROM gis_osm_roads_free_1 WHERE fclass='motorway'"</span></span>
<span id="cb25-261"><a href="#cb25-261"></a></span>
<span id="cb25-262"><a href="#cb25-262"></a><span class="co">#reading in highway data </span></span>
<span id="cb25-263"><a href="#cb25-263"></a>highways <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">file.path</span>(data,<span class="st">"gis_osm_roads_free_1.gpkg"</span>), <span class="at">query =</span> highway_query, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-264"><a href="#cb25-264"></a></span>
<span id="cb25-265"><a href="#cb25-265"></a><span class="co">#transforming highways crs to 3083</span></span>
<span id="cb25-266"><a href="#cb25-266"></a>highways <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(highways, <span class="dv">3083</span>)</span>
<span id="cb25-267"><a href="#cb25-267"></a></span>
<span id="cb25-268"><a href="#cb25-268"></a><span class="co">#creating a 200m buffer around highways </span></span>
<span id="cb25-269"><a href="#cb25-269"></a>high_buff <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(highways, <span class="at">dist =</span> <span class="dv">200</span>)</span>
<span id="cb25-270"><a href="#cb25-270"></a></span>
<span id="cb25-271"><a href="#cb25-271"></a><span class="co">#dissolveing buffers </span></span>
<span id="cb25-272"><a href="#cb25-272"></a>high_buff_dis <span class="ot">&lt;-</span> <span class="fu">st_union</span>(high_buff)</span>
<span id="cb25-273"><a href="#cb25-273"></a></span>
<span id="cb25-274"><a href="#cb25-274"></a><span class="co"># plot(high_buff_dis)</span></span>
<span id="cb25-275"><a href="#cb25-275"></a></span>
<span id="cb25-276"><a href="#cb25-276"></a><span class="co">#finding areas more than 200m from a highway that experienced a blackout </span></span>
<span id="cb25-277"><a href="#cb25-277"></a>mask_no_hwy <span class="ot">&lt;-</span> bo_mask_houst[high_buff_dis, op <span class="ot">=</span> st_disjoint]</span>
<span id="cb25-278"><a href="#cb25-278"></a><span class="in">```</span></span>
<span id="cb25-279"><a href="#cb25-279"></a></span>
<span id="cb25-280"><a href="#cb25-280"></a><span class="fu">##### Check #2: see if the highway exclusion mask removed all polygons within the 200m of highways</span></span>
<span id="cb25-281"><a href="#cb25-281"></a><span class="in">```{r, results= TRUE}</span></span>
<span id="cb25-282"><a href="#cb25-282"></a><span class="do">#### creating a check #######</span></span>
<span id="cb25-283"><a href="#cb25-283"></a><span class="fu">cat</span>(<span class="st">"CHECK #2 - see if the highway exclusion mask removed all polygons within the 200m of highways:"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb25-284"><a href="#cb25-284"></a></span>
<span id="cb25-285"><a href="#cb25-285"></a></span>
<span id="cb25-286"><a href="#cb25-286"></a><span class="cf">if</span>(<span class="fu">nrow</span>(mask_no_hwy) <span class="sc">+</span> <span class="fu">nrow</span>(bo_mask_houst[high_buff_dis, ]) <span class="sc">==</span> <span class="fu">nrow</span>(bo_mask_houst)) {</span>
<span id="cb25-287"><a href="#cb25-287"></a>  <span class="fu">cat</span>(<span class="st">"Yes, the highway mask removed all polygons within the 200m of highways."</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb25-288"><a href="#cb25-288"></a>  } <span class="cf">else</span> {</span>
<span id="cb25-289"><a href="#cb25-289"></a>    <span class="fu">cat</span>(<span class="st">"Error! Observations within highway mask are included."</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb25-290"><a href="#cb25-290"></a>  }</span>
<span id="cb25-291"><a href="#cb25-291"></a></span>
<span id="cb25-292"><a href="#cb25-292"></a><span class="in">```</span></span>
<span id="cb25-293"><a href="#cb25-293"></a></span>
<span id="cb25-294"><a href="#cb25-294"></a><span class="kw">&lt;/br&gt;</span> </span>
<span id="cb25-295"><a href="#cb25-295"></a><span class="kw">&lt;/br&gt;</span></span>
<span id="cb25-296"><a href="#cb25-296"></a></span>
<span id="cb25-297"><a href="#cb25-297"></a><span class="fu">#### Find homes impacted by blackouts</span></span>
<span id="cb25-298"><a href="#cb25-298"></a></span>
<span id="cb25-299"><a href="#cb25-299"></a><span class="fu">##### load buildings data </span></span>
<span id="cb25-300"><a href="#cb25-300"></a></span>
<span id="cb25-301"><a href="#cb25-301"></a>The buildings dataset was then loaded in using <span class="in">`st_read`</span> and the following SQL query:</span>
<span id="cb25-302"><a href="#cb25-302"></a></span>
<span id="cb25-303"><a href="#cb25-303"></a><span class="in">`SELECT *`</span>&nbsp; <span class="in">`FROM gis_osm_buildings_a_free_1`</span></span>
<span id="cb25-304"><a href="#cb25-304"></a><span class="in">`WHERE (type IS NULL AND name IS NULL)`</span></span>
<span id="cb25-305"><a href="#cb25-305"></a><span class="in">`OR type in ('residential', 'apartments', 'house', 'static_caravan', 'detached')`</span>\</span>
<span id="cb25-306"><a href="#cb25-306"></a></span>
<span id="cb25-307"><a href="#cb25-307"></a>Again, this reduces the amount of data pulled inoto R, saving us time, energy, and storage.</span>
<span id="cb25-310"><a href="#cb25-310"></a><span class="in">```{r}</span></span>
<span id="cb25-311"><a href="#cb25-311"></a><span class="co">#making a query for pulling specific building data</span></span>
<span id="cb25-312"><a href="#cb25-312"></a>buildings_query <span class="ot">&lt;-</span> <span class="st">"SELECT * FROM gis_osm_buildings_a_free_1 WHERE (type IS NULL AND name IS NULL) OR type in ('residential', 'apartments', 'house', 'static_caravan', 'detached')"</span></span>
<span id="cb25-313"><a href="#cb25-313"></a></span>
<span id="cb25-314"><a href="#cb25-314"></a><span class="co">#reading in building data </span></span>
<span id="cb25-315"><a href="#cb25-315"></a>buildings <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">file.path</span>(data, <span class="st">"gis_osm_buildings_a_free_1.gpkg"</span>), <span class="at">query =</span> buildings_query, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-316"><a href="#cb25-316"></a></span>
<span id="cb25-317"><a href="#cb25-317"></a><span class="co">#transforming crs to 3083 </span></span>
<span id="cb25-318"><a href="#cb25-318"></a>buildings <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(buildings, <span class="dv">3083</span>)</span>
<span id="cb25-319"><a href="#cb25-319"></a></span>
<span id="cb25-320"><a href="#cb25-320"></a><span class="co"># plot(buildings)</span></span>
<span id="cb25-321"><a href="#cb25-321"></a><span class="in">```</span></span>
<span id="cb25-322"><a href="#cb25-322"></a></span>
<span id="cb25-323"><a href="#cb25-323"></a></span>
<span id="cb25-324"><a href="#cb25-324"></a><span class="fu">##### find homes in blackout areas </span></span>
<span id="cb25-325"><a href="#cb25-325"></a></span>
<span id="cb25-326"><a href="#cb25-326"></a>I then filtered the mask to homes within blackout areas and counted the number of impacted homes.</span>
<span id="cb25-327"><a href="#cb25-327"></a></span>
<span id="cb25-328"><a href="#cb25-328"></a><span class="in">```{r, results = TRUE}</span></span>
<span id="cb25-329"><a href="#cb25-329"></a><span class="co">#subsettign the number of homes experiencing blackouts </span></span>
<span id="cb25-330"><a href="#cb25-330"></a><span class="co">#I am including areas inside of houston that also extend outside of Houston border using st_intersects</span></span>
<span id="cb25-331"><a href="#cb25-331"></a>bo_homes <span class="ot">&lt;-</span> buildings[mask_no_hwy, ]</span>
<span id="cb25-332"><a href="#cb25-332"></a></span>
<span id="cb25-333"><a href="#cb25-333"></a><span class="co">#counting blackout homes</span></span>
<span id="cb25-334"><a href="#cb25-334"></a>bo_homes_cnt <span class="ot">&lt;-</span> <span class="fu">comma</span>(<span class="fu">nrow</span>(bo_homes))</span>
<span id="cb25-335"><a href="#cb25-335"></a></span>
<span id="cb25-336"><a href="#cb25-336"></a><span class="fu">cat</span>(<span class="st">"Number of homes that experienced blackouts during the storm:"</span>, bo_homes_cnt, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb25-337"><a href="#cb25-337"></a></span>
<span id="cb25-338"><a href="#cb25-338"></a><span class="in">```</span></span>
<span id="cb25-339"><a href="#cb25-339"></a></span>
<span id="cb25-340"><a href="#cb25-340"></a><span class="kw">&lt;/br&gt;</span></span>
<span id="cb25-341"><a href="#cb25-341"></a></span>
<span id="cb25-342"><a href="#cb25-342"></a><span class="fu">#### Investigate socioeconomic factors</span></span>
<span id="cb25-343"><a href="#cb25-343"></a></span>
<span id="cb25-344"><a href="#cb25-344"></a><span class="fu">##### load ACS data </span></span>
<span id="cb25-345"><a href="#cb25-345"></a></span>
<span id="cb25-346"><a href="#cb25-346"></a>First, I read in the geodatabase layers using <span class="in">`st_read()`</span> (geometries are stored in the <span class="in">`ACS_2019_5YR_TRACT_48_TEXAS`</span> layer and income data is stored in the <span class="in">`X19_INCOME`</span> layer).</span>
<span id="cb25-347"><a href="#cb25-347"></a>For this analysis, I used the median income field <span class="in">`B19013e1`</span> for income.</span>
<span id="cb25-348"><a href="#cb25-348"></a>Data was then reprojected to EPSG:3083.</span>
<span id="cb25-349"><a href="#cb25-349"></a></span>
<span id="cb25-352"><a href="#cb25-352"></a><span class="in">```{r}</span></span>
<span id="cb25-353"><a href="#cb25-353"></a><span class="co"># reading ACS gdb layers</span></span>
<span id="cb25-354"><a href="#cb25-354"></a><span class="fu">st_layers</span>(<span class="fu">file.path</span>(data, <span class="st">"ACS_2019_5YR_TRACT_48_TEXAS.gdb"</span>))</span>
<span id="cb25-355"><a href="#cb25-355"></a></span>
<span id="cb25-356"><a href="#cb25-356"></a><span class="co"># reading in geometries layer</span></span>
<span id="cb25-357"><a href="#cb25-357"></a>acs_geoms <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">file.path</span>(data, <span class="st">"ACS_2019_5YR_TRACT_48_TEXAS.gdb"</span>), <span class="at">layer =</span> <span class="st">"ACS_2019_5YR_TRACT_48_TEXAS"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-358"><a href="#cb25-358"></a>  <span class="fu">st_transform</span>(<span class="st">"EPSG:3083"</span>)</span>
<span id="cb25-359"><a href="#cb25-359"></a></span>
<span id="cb25-360"><a href="#cb25-360"></a><span class="co"># reading in income layer</span></span>
<span id="cb25-361"><a href="#cb25-361"></a><span class="co">#selecting just GEOID and median income </span></span>
<span id="cb25-362"><a href="#cb25-362"></a>acs_income <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">file.path</span>(data, <span class="st">"ACS_2019_5YR_TRACT_48_TEXAS.gdb"</span>), <span class="at">layer =</span> <span class="st">"X19_INCOME"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-363"><a href="#cb25-363"></a>  <span class="fu">select</span>(<span class="at">GEOID_Data =</span> GEOID, <span class="at">med_income =</span> B19013e1)</span>
<span id="cb25-364"><a href="#cb25-364"></a>  </span>
<span id="cb25-365"><a href="#cb25-365"></a></span>
<span id="cb25-366"><a href="#cb25-366"></a></span>
<span id="cb25-367"><a href="#cb25-367"></a><span class="in">```</span></span>
<span id="cb25-368"><a href="#cb25-368"></a></span>
<span id="cb25-369"><a href="#cb25-369"></a></span>
<span id="cb25-370"><a href="#cb25-370"></a></span>
<span id="cb25-371"><a href="#cb25-371"></a><span class="fu">##### determine which census tracts experienced blackouts </span></span>
<span id="cb25-372"><a href="#cb25-372"></a></span>
<span id="cb25-373"><a href="#cb25-373"></a>Next, I joined the income data to the census tract geometries uaing a <span class="in">`left_join`</span> function by "ID". This was then spatially joined to the census tract data with buildings determined to be impacted by blackouts using the <span class="in">`st_intersects`</span> operation. Lastly, census tracts that had blackouts were identified.</span>
<span id="cb25-374"><a href="#cb25-374"></a></span>
<span id="cb25-375"><a href="#cb25-375"></a><span class="in">```{r, results = TRUE}</span></span>
<span id="cb25-376"><a href="#cb25-376"></a></span>
<span id="cb25-377"><a href="#cb25-377"></a><span class="co">#finding out how many and which census tracts experienced a blackout</span></span>
<span id="cb25-378"><a href="#cb25-378"></a></span>
<span id="cb25-379"><a href="#cb25-379"></a><span class="co">#joining income data to geometries </span></span>
<span id="cb25-380"><a href="#cb25-380"></a>acs_join <span class="ot">&lt;-</span> <span class="fu">left_join</span>(acs_geoms, acs_income)</span>
<span id="cb25-381"><a href="#cb25-381"></a></span>
<span id="cb25-382"><a href="#cb25-382"></a><span class="co"># spatial join census tract data with buildings </span></span>
<span id="cb25-383"><a href="#cb25-383"></a>spat_join <span class="ot">&lt;-</span> acs_join <span class="sc">%&gt;%</span> </span>
<span id="cb25-384"><a href="#cb25-384"></a>   <span class="fu">st_filter</span>(bo_homes, <span class="at">.predicate =</span> st_intersects)</span>
<span id="cb25-385"><a href="#cb25-385"></a></span>
<span id="cb25-386"><a href="#cb25-386"></a><span class="co"># length(spat_join)</span></span>
<span id="cb25-387"><a href="#cb25-387"></a><span class="co"># names(spat_join)</span></span>
<span id="cb25-388"><a href="#cb25-388"></a></span>
<span id="cb25-389"><a href="#cb25-389"></a><span class="co">#census tracts that experience a blackout</span></span>
<span id="cb25-390"><a href="#cb25-390"></a>bo_tract_list <span class="ot">&lt;-</span> <span class="fu">unique</span>(spat_join<span class="sc">$</span>NAMELSAD)</span>
<span id="cb25-391"><a href="#cb25-391"></a></span>
<span id="cb25-392"><a href="#cb25-392"></a><span class="co">#count of census tracts that experience a blackout</span></span>
<span id="cb25-393"><a href="#cb25-393"></a>bo_tract_count <span class="ot">&lt;-</span> <span class="fu">length</span>(bo_tract_list)</span>
<span id="cb25-394"><a href="#cb25-394"></a></span>
<span id="cb25-395"><a href="#cb25-395"></a></span>
<span id="cb25-396"><a href="#cb25-396"></a><span class="in">```</span></span>
<span id="cb25-397"><a href="#cb25-397"></a></span>
<span id="cb25-398"><a href="#cb25-398"></a></span>
<span id="cb25-399"><a href="#cb25-399"></a><span class="fu">##### CHECK #3: making sure only census tracts with homes that experienced a blackout are included:</span></span>
<span id="cb25-400"><a href="#cb25-400"></a><span class="in">```{r, results = TRUE}</span></span>
<span id="cb25-401"><a href="#cb25-401"></a><span class="do">### creating a check #####</span></span>
<span id="cb25-402"><a href="#cb25-402"></a><span class="fu">cat</span>(<span class="st">"CHECK #3 - making sure only census tracts with homes that experienced a blackout are included:"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb25-403"><a href="#cb25-403"></a></span>
<span id="cb25-404"><a href="#cb25-404"></a><span class="cf">if</span>(<span class="fu">nrow</span>(acs_join) <span class="sc">&gt;</span> <span class="fu">nrow</span>(spat_join)) {</span>
<span id="cb25-405"><a href="#cb25-405"></a>  <span class="fu">cat</span>(<span class="st">"Yes, only black out census tracts included."</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb25-406"><a href="#cb25-406"></a>} <span class="cf">else</span> {</span>
<span id="cb25-407"><a href="#cb25-407"></a>  <span class="fu">cat</span>(<span class="st">"No, filter didn't work"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb25-408"><a href="#cb25-408"></a>}</span>
<span id="cb25-409"><a href="#cb25-409"></a></span>
<span id="cb25-410"><a href="#cb25-410"></a><span class="in">```</span></span>
<span id="cb25-411"><a href="#cb25-411"></a></span>
<span id="cb25-412"><a href="#cb25-412"></a></span>
<span id="cb25-413"><a href="#cb25-413"></a></span>
<span id="cb25-414"><a href="#cb25-414"></a><span class="fu">##### compare incomes of impacted tracts to unimpacted tracts </span></span>
<span id="cb25-415"><a href="#cb25-415"></a></span>
<span id="cb25-416"><a href="#cb25-416"></a>Finally, I created a map of median income by census tract and designated which tracts experienced blackouts. I then plot the distribution of income in impacted and nonimpacted tracts to visualize what the spread of the community income looked like.</span>
<span id="cb25-417"><a href="#cb25-417"></a></span>
<span id="cb25-418"><a href="#cb25-418"></a><span class="in">```{r, out.width = "100%", fig.align = "center",fig.cap = "**Figure 1. Median income of census tracts in Houston, TX that experienced blackouts in February 2021.** Map **A** shows all census tracts in Houston area, were tracts that experienced a blackout color coded by the median income of houslholds within the tracts. Brighter colored tracts have higher median incomes where darker colored tracts have lower. Map **B** shows an inset map of where Houston is located in the state of Texas."  }</span></span>
<span id="cb25-419"><a href="#cb25-419"></a></span>
<span id="cb25-420"><a href="#cb25-420"></a></span>
<span id="cb25-421"><a href="#cb25-421"></a><span class="co"># In this section, I am mapping the median income of affected census tracts from the black out to visually show what the income of affected areas are in Houston</span></span>
<span id="cb25-422"><a href="#cb25-422"></a></span>
<span id="cb25-423"><a href="#cb25-423"></a><span class="co">#check census tract crs</span></span>
<span id="cb25-424"><a href="#cb25-424"></a><span class="fu">st_crs</span>(acs_join)</span>
<span id="cb25-425"><a href="#cb25-425"></a></span>
<span id="cb25-426"><a href="#cb25-426"></a><span class="co">#transform Houston polygon crs to match census tract crs</span></span>
<span id="cb25-427"><a href="#cb25-427"></a>hstn_3083 <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(hstn_sf, <span class="dv">3083</span>)</span>
<span id="cb25-428"><a href="#cb25-428"></a></span>
<span id="cb25-429"><a href="#cb25-429"></a><span class="co"># masking census tracts to houston</span></span>
<span id="cb25-430"><a href="#cb25-430"></a>tract_mask <span class="ot">&lt;-</span> acs_join[hstn_3083, ]</span>
<span id="cb25-431"><a href="#cb25-431"></a></span>
<span id="cb25-432"><a href="#cb25-432"></a><span class="co">#making a new column saying whether or not tracts was a black out or not</span></span>
<span id="cb25-433"><a href="#cb25-433"></a>tract_mask <span class="ot">&lt;-</span> tract_mask <span class="sc">%&gt;%</span> </span>
<span id="cb25-434"><a href="#cb25-434"></a>  <span class="fu">mutate</span>(<span class="at">blackout =</span> <span class="fu">ifelse</span>(NAMELSAD <span class="sc">%in%</span> bo_tract_list, <span class="st">"TRUE"</span>, <span class="st">"FALSE"</span>))</span>
<span id="cb25-435"><a href="#cb25-435"></a></span>
<span id="cb25-436"><a href="#cb25-436"></a></span>
<span id="cb25-437"><a href="#cb25-437"></a></span>
<span id="cb25-438"><a href="#cb25-438"></a><span class="co"># mapping median income of census tracts that experienced blackouts</span></span>
<span id="cb25-439"><a href="#cb25-439"></a></span>
<span id="cb25-440"><a href="#cb25-440"></a><span class="co"># getting a polygon of texas </span></span>
<span id="cb25-441"><a href="#cb25-441"></a>texas <span class="ot">&lt;-</span> us_states <span class="sc">%&gt;%</span> </span>
<span id="cb25-442"><a href="#cb25-442"></a>  <span class="fu">filter</span>(NAME <span class="sc">==</span> <span class="st">"Texas"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-443"><a href="#cb25-443"></a>  <span class="fu">st_transform</span>(<span class="dv">3083</span>)</span>
<span id="cb25-444"><a href="#cb25-444"></a></span>
<span id="cb25-445"><a href="#cb25-445"></a><span class="co">#making an inset map of texas with Houston filled in red  </span></span>
<span id="cb25-446"><a href="#cb25-446"></a>inset_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb25-447"><a href="#cb25-447"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> texas) <span class="sc">+</span> </span>
<span id="cb25-448"><a href="#cb25-448"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> hstn_3083, <span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb25-449"><a href="#cb25-449"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb25-450"><a href="#cb25-450"></a>   <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-451"><a href="#cb25-451"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-452"><a href="#cb25-452"></a>  <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-453"><a href="#cb25-453"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span>
<span id="cb25-454"><a href="#cb25-454"></a></span>
<span id="cb25-455"><a href="#cb25-455"></a></span>
<span id="cb25-456"><a href="#cb25-456"></a><span class="co">#creating a main map of census tracts that experienced blackouts by color </span></span>
<span id="cb25-457"><a href="#cb25-457"></a>main_map <span class="ot">&lt;-</span></span>
<span id="cb25-458"><a href="#cb25-458"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb25-459"><a href="#cb25-459"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> tract_mask, <span class="at">color =</span> <span class="st">"lightgrey"</span>) <span class="sc">+</span></span>
<span id="cb25-460"><a href="#cb25-460"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> spat_join, <span class="fu">aes</span>(<span class="at">fill =</span> med_income)) <span class="sc">+</span></span>
<span id="cb25-461"><a href="#cb25-461"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb25-462"><a href="#cb25-462"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Median Income ($)"</span>) <span class="sc">+</span></span>
<span id="cb25-463"><a href="#cb25-463"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-464"><a href="#cb25-464"></a>  <span class="fu">annotation_scale</span>(<span class="at">plot_unit =</span> <span class="st">"m"</span>, <span class="at">location =</span> <span class="st">"bl"</span>) <span class="sc">+</span></span>
<span id="cb25-465"><a href="#cb25-465"></a>  <span class="fu">theme</span>( <span class="at">legend.position=</span> <span class="fu">c</span>(<span class="fl">1.25</span>, .<span class="dv">75</span>),</span>
<span id="cb25-466"><a href="#cb25-466"></a>         <span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,.<span class="dv">5</span>,<span class="dv">1</span>),<span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb25-467"><a href="#cb25-467"></a>  <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">"bl"</span>,</span>
<span id="cb25-468"><a href="#cb25-468"></a>                         <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="fl">0.05</span>, <span class="st">"in"</span>),</span>
<span id="cb25-469"><a href="#cb25-469"></a>                         <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"in"</span>),</span>
<span id="cb25-470"><a href="#cb25-470"></a>                         <span class="at">style =</span> ggspatial<span class="sc">::</span><span class="fu">north_arrow_minimal</span>())</span>
<span id="cb25-471"><a href="#cb25-471"></a></span>
<span id="cb25-472"><a href="#cb25-472"></a><span class="co">#combining main and inset map </span></span>
<span id="cb25-473"><a href="#cb25-473"></a> comb_map <span class="ot">&lt;-</span> main_map <span class="sc">+</span> </span>
<span id="cb25-474"><a href="#cb25-474"></a>    <span class="fu">inset_element</span>(inset_map, <span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">1.4</span>, .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb25-475"><a href="#cb25-475"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb25-476"><a href="#cb25-476"></a> </span>
<span id="cb25-477"><a href="#cb25-477"></a> comb_map</span>
<span id="cb25-478"><a href="#cb25-478"></a></span>
<span id="cb25-479"><a href="#cb25-479"></a></span>
<span id="cb25-480"><a href="#cb25-480"></a></span>
<span id="cb25-481"><a href="#cb25-481"></a><span class="in">```</span></span>
<span id="cb25-482"><a href="#cb25-482"></a></span>
<span id="cb25-483"><a href="#cb25-483"></a><span class="kw">&lt;/br&gt;</span> </span>
<span id="cb25-484"><a href="#cb25-484"></a></span>
<span id="cb25-485"><a href="#cb25-485"></a></span>
<span id="cb25-486"><a href="#cb25-486"></a><span class="in">```{r, fig.align = 'center', fig.cap = "**Figure 2. Median houshold income distribution of census tracts in blackout vs non-blackout areas in Houston, 2021.** The first plot **A** shows a histogram of the distribution of median income in both groups of tracts. The frequency is concentrated just under $50,000 for both groups. Data is abnormally distributed with a long right tail, indiating most housholds are lower income with some higher income households drawing the tail right. Plot **B** shows a whisker plot of median distribution. Boxes represent the inter quartile range (IQR, 50% of the data), and the line inside each box represents the median. The whiskers represent 1.5 times the length of the IQR, with some outliers falling above the whiskers." }</span></span>
<span id="cb25-487"><a href="#cb25-487"></a></span>
<span id="cb25-488"><a href="#cb25-488"></a><span class="co"># here I am creating a histogram and box plot to compare the median incomes of affected and unaffected tracts</span></span>
<span id="cb25-489"><a href="#cb25-489"></a></span>
<span id="cb25-490"><a href="#cb25-490"></a><span class="co">#first, calculate median of median incomes for both groups </span></span>
<span id="cb25-491"><a href="#cb25-491"></a>meds <span class="ot">&lt;-</span> tract_mask <span class="sc">%&gt;%</span> </span>
<span id="cb25-492"><a href="#cb25-492"></a>  <span class="fu">group_by</span>(blackout) <span class="sc">%&gt;%</span> </span>
<span id="cb25-493"><a href="#cb25-493"></a>  <span class="fu">summarize</span>(<span class="at">med_med_income =</span> <span class="fu">median</span>(med_income, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-494"><a href="#cb25-494"></a>  <span class="fu">st_drop_geometry</span>()</span>
<span id="cb25-495"><a href="#cb25-495"></a></span>
<span id="cb25-496"><a href="#cb25-496"></a></span>
<span id="cb25-497"><a href="#cb25-497"></a><span class="co">#creating a histogram of income distribution </span></span>
<span id="cb25-498"><a href="#cb25-498"></a>hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tract_mask, <span class="fu">aes</span>(<span class="at">x =</span> med_income, <span class="at">fill =</span> blackout)) <span class="sc">+</span></span>
<span id="cb25-499"><a href="#cb25-499"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">65</span>) <span class="sc">+</span></span>
<span id="cb25-500"><a href="#cb25-500"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Median income ($)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb25-501"><a href="#cb25-501"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-502"><a href="#cb25-502"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb25-503"><a href="#cb25-503"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> meds, <span class="fu">aes</span>(<span class="at">x =</span> med_med_income, <span class="at">xend =</span> med_med_income, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">80</span>, <span class="at">color =</span> blackout), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb25-504"><a href="#cb25-504"></a>  <span class="co"># geom_vline(data = meds, aes(xintercept = med_med_income, color = blackout), linetype = "dashed") +</span></span>
<span id="cb25-505"><a href="#cb25-505"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>( <span class="st">"lightblue"</span>, <span class="st">"orange"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No blackouts"</span>, <span class="st">"Blackouts"</span> )) <span class="sc">+</span></span>
<span id="cb25-506"><a href="#cb25-506"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Median"</span>, <span class="at">values =</span> <span class="fu">c</span>( <span class="st">"blue"</span>, <span class="st">"orange3"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No blackouts"</span>, <span class="st">"Blackouts"</span> )) </span>
<span id="cb25-507"><a href="#cb25-507"></a>  <span class="co"># coord_cartesian(ylim = c(0, 75))</span></span>
<span id="cb25-508"><a href="#cb25-508"></a>  </span>
<span id="cb25-509"><a href="#cb25-509"></a>  </span>
<span id="cb25-510"><a href="#cb25-510"></a><span class="co">#creating a boxplot of median income distribution </span></span>
<span id="cb25-511"><a href="#cb25-511"></a>box_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tract_mask, <span class="fu">aes</span>(<span class="at">x =</span> blackout, <span class="at">y =</span> med_income, <span class="at">fill =</span> blackout)) <span class="sc">+</span></span>
<span id="cb25-512"><a href="#cb25-512"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb25-513"><a href="#cb25-513"></a>  <span class="co"># geom_jitter(width = 0.2, alpha = 0.5, color = "grey") +  </span></span>
<span id="cb25-514"><a href="#cb25-514"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Median Income ($)"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb25-515"><a href="#cb25-515"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-516"><a href="#cb25-516"></a>  <span class="fu">scale_fill_manual</span>( <span class="at">name =</span> <span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>( <span class="st">"lightblue"</span>, <span class="st">"orange"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No blackouts"</span>, <span class="st">"Blackouts"</span>)) <span class="sc">+</span></span>
<span id="cb25-517"><a href="#cb25-517"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"No blackouts"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"Blackouts"</span>)) </span>
<span id="cb25-518"><a href="#cb25-518"></a></span>
<span id="cb25-519"><a href="#cb25-519"></a></span>
<span id="cb25-520"><a href="#cb25-520"></a><span class="co">#adding up plots into one using patchwork</span></span>
<span id="cb25-521"><a href="#cb25-521"></a>patched <span class="ot">&lt;-</span> hist <span class="sc">+</span> box_p <span class="sc">+</span> </span>
<span id="cb25-522"><a href="#cb25-522"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>) <span class="sc">+</span></span>
<span id="cb25-523"><a href="#cb25-523"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">&amp;</span></span>
<span id="cb25-524"><a href="#cb25-524"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb25-525"><a href="#cb25-525"></a></span>
<span id="cb25-526"><a href="#cb25-526"></a>patched</span>
<span id="cb25-527"><a href="#cb25-527"></a></span>
<span id="cb25-528"><a href="#cb25-528"></a></span>
<span id="cb25-529"><a href="#cb25-529"></a><span class="in">```</span></span>
<span id="cb25-530"><a href="#cb25-530"></a></span>
<span id="cb25-531"><a href="#cb25-531"></a></span>
<span id="cb25-532"><a href="#cb25-532"></a></span>
<span id="cb25-533"><a href="#cb25-533"></a><span class="fu">### Conclusion</span></span>
<span id="cb25-534"><a href="#cb25-534"></a></span>
<span id="cb25-535"><a href="#cb25-535"></a>Overall, these results show that census tracts had a similar median</span>
<span id="cb25-536"><a href="#cb25-536"></a>income distribution regardless of whether or not they experienced a</span>
<span id="cb25-537"><a href="#cb25-537"></a>black out in the February 2021 storm, but income was slightly higher for tracts that experienced a blackout than those that did not. The median of the census tract median income distribution was $<span class="in">`r prettyNum(round(meds[1,2]), big.mark=",")`</span> for non-blackout tracts and </span>
<span id="cb25-538"><a href="#cb25-538"></a>$<span class="in">`r prettyNum(round(meds[2,2]), big.mark=",")`</span> for blackout tracts. The majority of the income</span>
<span id="cb25-539"><a href="#cb25-539"></a>distribution is centered at about $35,000 - </span>
<span id="cb25-540"><a href="#cb25-540"></a>$45,000, with some outliers in the</span>
<span id="cb25-541"><a href="#cb25-541"></a>\$200,000 + range. Some of the limitations of the study are that the</span>
<span id="cb25-542"><a href="#cb25-542"></a>census tracts don't represent how many homes experienced a black out or</span>
<span id="cb25-543"><a href="#cb25-543"></a>how long the black out was experienced for. These factors could have</span>
<span id="cb25-544"><a href="#cb25-544"></a>underlying socioeconomic patterns that we can't see here which could explain why certain tracts experienced blackouts for the duration that they did. This should be an area for future investigation to strengthen the results found in this study.</span>
<span id="cb25-545"><a href="#cb25-545"></a></span>
<span id="cb25-546"><a href="#cb25-546"></a></span>
<span id="cb25-547"><a href="#cb25-547"></a></span>
<span id="cb25-548"><a href="#cb25-548"></a></span>
<span id="cb25-549"><a href="#cb25-549"></a></span>
<span id="cb25-550"><a href="#cb25-550"></a></span>
<span id="cb25-551"><a href="#cb25-551"></a></span>
<span id="cb25-552"><a href="#cb25-552"></a></span>
<span id="cb25-553"><a href="#cb25-553"></a></span>
<span id="cb25-554"><a href="#cb25-554"></a></span>
<span id="cb25-555"><a href="#cb25-555"></a></span>
<span id="cb25-556"><a href="#cb25-556"></a></span>
<span id="cb25-557"><a href="#cb25-557"></a></span>
<span id="cb25-558"><a href="#cb25-558"></a></span>
<span id="cb25-559"><a href="#cb25-559"></a></span>
<span id="cb25-560"><a href="#cb25-560"></a></span>
<span id="cb25-561"><a href="#cb25-561"></a></span>
<span id="cb25-562"><a href="#cb25-562"></a></span>
<span id="cb25-563"><a href="#cb25-563"></a></span>
<span id="cb25-564"><a href="#cb25-564"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Copyright 2023, Raymond Hunter
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Made using Quarto
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>