{
  "hash": "d07db7eb081ec84f249ff28e3dc83ac8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data Pipelines with {Targets}\"\ndescription: \"An R package for creating reproducible workflows\"\nauthor:\n  - name: Raymond Hunter \n    url: <https://ramhunte.github.io/\ndate: 7-10-2025\n# bibliography: references.bib\ncitation: \n  url: <https://ramhunte.github.io/blogs/targets_wflow/\nbibliography: references.bib\nimage: images/eye_sauron.jpg\ncategories: [Reproducible Pipelines] # self-defined categories\nformat: \n  html: \n    # code-fold: show \n    code-copy: true \n    code-summary: \"code\" \n    code-line-numbers: false \n    code-tools: true \n    code-block-border-left: true\n    # embed-resources: true\n    warning: false\n    message: false\ntoc: true\ndraft: false # setting this to `true` will prevent your post from appearing on your listing page until you're ready!\n---\n\n\n\nIf you’re reading this post, chances are you’re familiar with the process of collecting, cleaning, wrangling, and analyzing data. You’re probably also familiar with that dreaded moment—discovering an error (or receiving critical feedback from a supervisor) right at the finish line, forcing you to go aaalllllll the way back and re-run your time- and energy-intensive workflow.\n\nWorse yet, your pipeline has grown so cluttered and poorly documented from rushed, repeated fixes and edits that you’re no longer sure which parts of your code are still relevant. The result? A frustrating, tangled mess of rework. \n\nFortunately, there’s an R package designed to break this loop and make your work as an analyst, developer, or scientist far more efficient and enjoyable. It’s called `{targets}` [@Landau2021a].\n\n<br>\n\n## What is {targets}?\n\n<img src=\"images/eye_sauron.jpg\" class = \"float-right-image\" alt=\"The Eye of Sauron from the Lord of the Rings trilogy\">\n\n\n`{targets}` is an R package that helps organize, structure, and track the components of your analytical pipeline, making it more reproducible, scalable, and robust. It monitors the code and outputs of each step (or “target”) in your workflow to ensure they stay up to date when something changes—and, more importantly, to avoid rerunning steps that haven’t changed. This speeds up your analysis by only re-running code that has been modified (and its downstream dependencies). `{targets}` also flags steps that have changed but haven’t yet been executed, so you know exactly where to focus your attention in a pipeline. It encourages efficient, clean, and function-oriented code. While it may take a bit more effort to set up at first, the payoff in saved time and reduced frustration is well worth it.\n\nI sort of see it as The Eye of Sauron from JRR Tolkien's The Lord of the Rings. Sauron (or the `{targets}` package in this case) is ceaselessly scouring Middle Earth (your analytical pipeline) with an everlasting, burning desire to find the ring (changes in your code) so that he can resume full power (update your code). \n\n\n\n<br>\n\n## A simple analysis\n\nLets run through a simple analysis using `{palmerpenguins}` data without targets so we can later apply it and see the magic. \n\nMaybe we are interested in seeing if penguin flipper length can be predicted by other physical characteristics of the animal. Here is a short workflow on how one might approach this analysis.\n\n<br>\n\n### Set Up\n\nWe start by installing and loading the necessary packages and reading in the data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install packages if not already\n# install.packages(c(\"palmerpenguins\", \"janitor\", \"tidyverse\", \"targets\"))\n\n# load packages\nlibrary(\"palmerpenguins\") # penguin data \nlibrary(\"janitor\") # cleaning column names\nlibrary(\"tidyverse\") # collection of data processing packages\nlibrary(\"targets\")\n\n# read data\npenguins <- palmerpenguins::penguins\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n\n<br>\n\n### Wrangling data\n\nIts critical to clean up and inspect the data prior to analysis. Fortunately for this simple example, `palmerpenguins` data is relatively clean already. Lets just touch up and filter some of those column names.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins_mod <- penguins |> # raw data\n  janitor::clean_names() |> # make columns lower case and remove spaces\n  mutate(name = stringr::word(species, 1)) |>   # add a species name column\n  dplyr::select(name, island, flipper_length_mm, body_mass_g, bill_length_mm, sex)\n```\n:::\n\n\n\n\n<br>\n\n\n### Exploratory data analysis\n\nBefore conducting any modeling, you should thoroughly check the quality of the data and assumptions being made. There is no single way on how to perform *exploratory data analysis* as it is subjective to the data in hand and the question being asked. \n\nWe will inspect a possible linear relationship between body mass and flipper length by species.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# visualizing relationship of body mass and flipper length of penguins\nggplot(data = penguins_mod,\n       aes(x = body_mass_g, y = flipper_length_mm, color = name)) + \n  geom_point() + # add data points\n  geom_smooth(method = \"lm\", se = FALSE) +  # Add trend lines for each species\n  labs(\n    y = \"Flipper Length (mm)\",\n    x = \"Body Mass (g)\",\n    title = \"Penguin Body Mass by Flipper Length\",\n    color = \"Species\"        \n  ) +\n  scale_color_manual( # changing colors \n    values = c(\n      \"Adelie\" = \"blue4\", \n      \"Chinstrap\" = \"tan\",     \n      \"Gentoo\" = \"darkgreen\"   \n    )) +\n  theme_minimal() # minimal appearance\n```\n\n::: {.cell-output-display}\n![Figure 1. A graph showign linear relationship between Body Mass (g) and Flipper Length (mm) across penguin species.](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n<br>\n\n### Modeling\n\nThe plot suggested a potential linear relationship between flipper length and body mass, varying by species. There are many possible models and explanatory variables we could explore to better understand this relationship. For now, let’s start with a simple ordinary least squares (OLS) linear regression model to examine how body mass, species, and sex influence the flipper length of penguins.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# fitting a linear regression model \nm1 <- lm(flipper_length_mm ~ body_mass_g + name + sex, \n         data = penguins_mod)\n```\n:::\n\n\n\n<br>\n\n### Results\n\nWe should create a summary table of model coefficients to help contextualize the magnitude of effects and their statistical significance. We’ll also inspect the R-squared value as an estimate of overall model fit.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# model coefficients \nsummary(m1)$coefficients |> \n  as.data.frame() |> \n  knitr::kable( \n    digits = 2)\n```\n\n::: {.cell-output-display}\n\n\nTable: Table 1. OLS Regression Summary: Predicting Penguin Flipper Length\n\n|              | Estimate| Std. Error| t value| Pr(>&#124;t&#124;)|\n|:-------------|--------:|----------:|-------:|------------------:|\n|(Intercept)   |   164.59|       3.18|   51.70|                  0|\n|body_mass_g   |     0.01|       0.00|    7.04|                  0|\n|nameChinstrap |     5.54|       0.79|    7.06|                  0|\n|nameGentoo    |    18.02|       1.44|   12.49|                  0|\n|sexmale       |     2.48|       0.85|    2.90|                  0|\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# model r squared \nsummary(m1)$r.squared[1] %>% \n  round(2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.86\n```\n\n\n:::\n:::\n\n\n\nAnd there you have it! A simple analysis of penguin data in R. Not too complicated, right? So, why do we need to use `{targets}`? \n\nImagine your supervisor asks you to investigate three different hypotheses using much larger datasets and a suite of machine learning models to identify the best predictors. Your exploratory data analysis becomes far more exhaustive, your models take minutes, hours, or even days to run, and your scripts grow increasingly difficult to manage. On top of that, you’re expected to write a report that will be scrutinized and sent back with edits—meaning you’ll have to re-run the entire process all over again.\n\n<br>\n\n## Using `{targets}`\n\nLets run through our pipeline again but applying targets this time.\n\n### 1. Function-orient your workflow\n\nA key programming best practice is to break your workflow into individual, customized functions. Functions make your code reusable, easier to modify, and more scalable—much more efficient than copying and pasting code repeatedly.\n\nTo get started, create a folder named `R` in your root directory (the main folder where your project’s code lives). Inside that folder, create a script called `functions.R` where you will store all your custom functions.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndir.create(\"R\") # creating an R folder in your working directory\n\nfile.create(\"R/functions.R\") # adding a functions script \n```\n:::\n\n\n\nonce inside this `functions.R` script, we will translate our original pipeline into individual functions:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# pull penguin data\npull_data <- function() {\n  return(palmerpenguins::penguins)\n  }\n\n\n# cleaning and wrangling data\nclean_data <- function(data) {\n  data |> # raw data\n    janitor::clean_names() |> # lower case columns\n    mutate(name = stringr::word(species, 1)) |>   # species name column\n    dplyr::select(name, island, flipper_length_mm, body_mass_g, sex) # selecting variables\n}\n\n\n# plot data\nplot_data <- function(data) {\n  ggplot(data = data, \n         aes(x = body_mass_g, y = flipper_length_mm, color = name)) + \n  geom_point() + # add data points\n  geom_smooth(method = \"lm\", se = FALSE) +  # Add trend lines for each species\n  labs(\n    y = \"Flipper Length (mm)\",\n    x = \"Body Mass (g)\",\n    title = \"Penguin Body Mass by Flipper Length\",\n    color = \"Species\"        \n  ) +\n  scale_color_manual( # changing colors \n    values = c(\n      \"Adelie\" = \"blue4\", \n      \"Chinstrap\" = \"tan\",     \n      \"Gentoo\" = \"darkgreen\"   \n    )) +\n  theme_minimal() # minimal appearance\n}\n\n\n# fit model\nfit_model <- function(data) {\n  lm(flipper_length_mm ~ body_mass_g + name + sex, data)\n}\n\n\n# model coefficients \nmodel_coefs <- function(model) {\n  summary(model)$coefficients |> \n    as.data.frame() |> \n    knitr::kable( \n      digits = 2)\n}\n\n\n# model r squared \nmodel_r2 <- function(model) {\n  summary(model)$r.squared\n}\n```\n:::\n\n\n\n<br> \n\n### 2. Create the `{targets}` skeleton\n\nNow that our workflow is neatly packaged into individual functions it is time to create the backbone of our pipeline, a `_targets.R` script. \n\nYou first need to run: \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntargets::use_targets()\n```\n:::\n\n\n\nThis will create a `_targets.R` file in your working directory. The file comes pre-populated with commented instructions and example code, many of which are irrelevant or optional for our example. *Important: Delete the example target code inside script before proceeding.*\n\nYou should then fill the file with the following structure:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# _targets.R file\n# Load packages required to define the pipeline:\nlibrary(targets)\n\n# Run the R scripts in the R/ folder with your custom functions:\ntar_source()\n\n# Set target options:\ntar_option_set(packages = c(\"palmerpenguins\", \"janitor\", \"tidyverse\")) # load packages\n\n# Here is where we define our targets using our custom functions\nlist(\n  tar_target(data, pull_data()), \n  tar_target(data_c, clean_data(data)),\n  tar_target(plot, plot_data(data_c)),\n  tar_target(model, fit_model(data_c)),\n  tar_target(coefs, model_coefs(model)),\n  tar_target(r2, model_r2(model))\n)\n```\n:::\n\n\n\nThis part can feel a little confusing, so let’s take it step by step.\n\nFirst, load the package with `library(targets)`.\nThen, use `tar_source()` to load all the functions from your `functions.R` script.\nNext, use `tar_option_set()` to load any packages your functions depend on.\nFinally, define your pipeline using `list(`) with individual `tar_target()` calls.\n\nEach `tar_target()` has two main parts:\n\n-   1. The name we are assigning to the target object\n\n-   2. The code used to generate it, often a function that may use upstream targets as inputs\n\nStill confused? That’s okay—let’s break down an example.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntar_target(data, data_pull())\n```\n:::\n\n\n\nThis tells `{targets}` to create a target called `data` using the `data_pull()` function we wrote earlier (which loads the penguins dataset).\n\nLets look at the next one:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntar_target(data_c, clean_data(data))\n```\n:::\n\n\n\nThis creates a new target called `data_c` using the `clean_data()` function—with data as its input. In other words, we used the `data` target inside a function to create a new target (`data_c`). Cool, right?\n\nAnd that’s the basic pattern we’ll follow for the rest of the pipeline.\n\n<br> \n\n\n### 3. Running {targets}\n\nLets look at our targets pipeline\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntargets::tar_visnetwork()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"visNetwork html-widget html-fill-item\" id=\"htmlwidget-da121f42ac3daf9e244c\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-da121f42ac3daf9e244c\">{\"x\":{\"nodes\":{\"name\":[\"clean_data\",\"coefs\",\"data\",\"data_c\",\"fit_model\",\"model\",\"model_coefs\",\"model_r2\",\"plot\",\"plot_data\",\"pull_data\",\"r2\"],\"type\":[\"function\",\"stem\",\"stem\",\"stem\",\"function\",\"stem\",\"function\",\"function\",\"stem\",\"function\",\"function\",\"stem\"],\"description\":[null,null,null,null,null,null,null,null,null,null,null,null],\"status\":[\"outdated\",\"outdated\",\"outdated\",\"outdated\",\"outdated\",\"outdated\",\"outdated\",\"outdated\",\"outdated\",\"outdated\",\"outdated\",\"outdated\"],\"seconds\":[null,null,null,null,null,null,null,null,null,null,null,null],\"bytes\":[null,null,null,null,null,null,null,null,null,null,null,null],\"branches\":[null,null,null,null,null,null,null,null,null,null,null,null],\"label\":[\"clean_data\",\"coefs\",\"data\",\"data_c\",\"fit_model\",\"model\",\"model_coefs\",\"model_r2\",\"plot\",\"plot_data\",\"pull_data\",\"r2\"],\"color\":[\"#78B7C5\",\"#78B7C5\",\"#78B7C5\",\"#78B7C5\",\"#78B7C5\",\"#78B7C5\",\"#78B7C5\",\"#78B7C5\",\"#78B7C5\",\"#78B7C5\",\"#78B7C5\",\"#78B7C5\"],\"id\":[\"clean_data\",\"coefs\",\"data\",\"data_c\",\"fit_model\",\"model\",\"model_coefs\",\"model_r2\",\"plot\",\"plot_data\",\"pull_data\",\"r2\"],\"level\":[1,5,2,3,1,4,1,1,4,1,1,5],\"shape\":[\"triangle\",\"dot\",\"dot\",\"dot\",\"triangle\",\"dot\",\"triangle\",\"triangle\",\"dot\",\"triangle\",\"triangle\",\"dot\"]},\"edges\":{\"from\":[\"model\",\"model_coefs\",\"pull_data\",\"clean_data\",\"data\",\"data_c\",\"fit_model\",\"data_c\",\"plot_data\",\"model_r2\",\"model\"],\"to\":[\"coefs\",\"coefs\",\"data\",\"data_c\",\"data_c\",\"model\",\"model\",\"plot\",\"plot\",\"r2\",\"r2\"],\"color\":[\"#78B7C5\",\"#78B7C5\",\"#78B7C5\",\"#78B7C5\",\"#78B7C5\",\"#78B7C5\",\"#78B7C5\",\"#78B7C5\",\"#78B7C5\",\"#78B7C5\",\"#78B7C5\"],\"arrows\":[\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":{\"type\":\"cubicBezier\",\"forceDirection\":\"horizontal\"}},\"physics\":{\"stabilization\":false},\"interaction\":{\"zoomSpeed\":1},\"layout\":{\"hierarchical\":{\"enabled\":true,\"levelSeparation\":180,\"direction\":\"LR\"}}},\"groups\":null,\"width\":null,\"height\":null,\"idselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":{\"text\":\"\",\"style\":\"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;\"},\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":{\"from\":1,\"to\":1},\"algorithm\":\"hierarchical\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":true,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"legend\":{\"width\":0.2,\"useGroups\":false,\"position\":\"right\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true,\"nodes\":{\"label\":[\"Outdated\",\"Function\",\"Stem\"],\"color\":[\"#78B7C5\",\"#899DA4\",\"#899DA4\"],\"shape\":[\"dot\",\"triangle\",\"dot\"]},\"nodesToDataframe\":true},\"tooltipStay\":300,\"tooltipStyle\":\"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n`{targets}` doesn’t just track dependencies—it also lets you visualize them and see which parts of your pipeline are related or out of date. In the visualization, functions appear as triangles, targets appear as circles, and arrows show relationships between them. If a target is blue, it means it’s outdated—either because its own code changed or because an upstream dependency changed. This will also trigger updates in downstream targets.\n\nWe haven't run our targets workflow yet, so it makes sense that everything is outdated. To run and update the pipeline, run:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntar_make() # updating and running our targets objects\n```\n:::\n\n\n\nAnd to visualize the update:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntar_visnetwork()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"visNetwork html-widget html-fill-item\" id=\"htmlwidget-f6e0599444621d7238e2\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-f6e0599444621d7238e2\">{\"x\":{\"nodes\":{\"name\":[\"clean_data\",\"coefs\",\"data\",\"data_c\",\"fit_model\",\"model\",\"model_coefs\",\"model_r2\",\"plot\",\"plot_data\",\"pull_data\",\"r2\"],\"type\":[\"function\",\"stem\",\"stem\",\"stem\",\"function\",\"stem\",\"function\",\"function\",\"stem\",\"function\",\"function\",\"stem\"],\"description\":[null,null,null,null,null,null,null,null,null,null,null,null],\"status\":[\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\"],\"seconds\":[null,0,0.5600000000000001,0.06,null,0,null,null,0.01,null,null,0],\"bytes\":[null,313,2915,2279,null,16642,null,null,132633,null,null,53],\"branches\":[null,null,null,null,null,null,null,null,null,null,null,null],\"label\":[\"clean_data\",\"coefs\",\"data\",\"data_c\",\"fit_model\",\"model\",\"model_coefs\",\"model_r2\",\"plot\",\"plot_data\",\"pull_data\",\"r2\"],\"color\":[\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\"],\"id\":[\"clean_data\",\"coefs\",\"data\",\"data_c\",\"fit_model\",\"model\",\"model_coefs\",\"model_r2\",\"plot\",\"plot_data\",\"pull_data\",\"r2\"],\"level\":[1,5,2,3,1,4,1,1,4,1,1,5],\"shape\":[\"triangle\",\"dot\",\"dot\",\"dot\",\"triangle\",\"dot\",\"triangle\",\"triangle\",\"dot\",\"triangle\",\"triangle\",\"dot\"]},\"edges\":{\"from\":[\"model\",\"model_coefs\",\"pull_data\",\"clean_data\",\"data\",\"data_c\",\"fit_model\",\"data_c\",\"plot_data\",\"model_r2\",\"model\"],\"to\":[\"coefs\",\"coefs\",\"data\",\"data_c\",\"data_c\",\"model\",\"model\",\"plot\",\"plot\",\"r2\",\"r2\"],\"color\":[\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\"],\"arrows\":[\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":{\"type\":\"cubicBezier\",\"forceDirection\":\"horizontal\"}},\"physics\":{\"stabilization\":false},\"interaction\":{\"zoomSpeed\":1},\"layout\":{\"hierarchical\":{\"enabled\":true,\"levelSeparation\":180,\"direction\":\"LR\"}}},\"groups\":null,\"width\":null,\"height\":null,\"idselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":{\"text\":\"\",\"style\":\"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;\"},\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":{\"from\":1,\"to\":1},\"algorithm\":\"hierarchical\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":true,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"legend\":{\"width\":0.2,\"useGroups\":false,\"position\":\"right\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true,\"nodes\":{\"label\":[\"Up to date\",\"Function\",\"Stem\"],\"color\":[\"#354823\",\"#899DA4\",\"#899DA4\"],\"shape\":[\"dot\",\"triangle\",\"dot\"]},\"nodesToDataframe\":true},\"tooltipStay\":300,\"tooltipStyle\":\"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\nAt this point, all of your target objects are up to date and reflected in the visual network. To test this, try running `tar_make()` again. You should see the message:\n*“skipped pipeline”*, indicating that nothing has changed and no targets need to be rebuilt.\n\nEach target is stored as an internal object managed by the package and won’t appear in your global environment like regular R objects. To access a specific target, you can load it manually using: `tar_load()`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntar_load(data) # load the target data\ntar_load(plot) # load the target plot\ntar_load(coefs) # load the target model coefficients table\n```\n:::\n\n\n\n\n### 4. Updating {targets}\n\nSo you ran your entire workflow using `{targets}`, wrote up some preliminary results, showed your boss, and she says: **\"Hey, i thought I asked you to put bill length as one of the model predictors in there. Can you go back and add that in there?\"** This would not be a big deal with such a small analysis such as this one. But, as you know, your analysis can become very large and difficult to track, re-run, and validate if not structured well. So lets test out what this change looks like here.\n\nWe go back into our `functions.R` script and add in bill length as a predictor.\n\n*NOTE: Always make sure to save your functions file after a change before running targets*\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# fit model with bill length\nfit_model <- function(data) {\n  lm(flipper_length_mm ~ body_mass_g + name + sex + bill_length_mm, data)\n}\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n\nHow has the pipeline changed?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntar_visnetwork() # visualize outdated targets objects\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"visNetwork html-widget html-fill-item\" id=\"htmlwidget-46b8ff57c257b744f586\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-46b8ff57c257b744f586\">{\"x\":{\"nodes\":{\"name\":[\"clean_data\",\"coefs\",\"data\",\"data_c\",\"fit_model\",\"model\",\"model_coefs\",\"model_r2\",\"plot\",\"plot_data\",\"pull_data\",\"r2\"],\"type\":[\"function\",\"stem\",\"stem\",\"stem\",\"function\",\"stem\",\"function\",\"function\",\"stem\",\"function\",\"function\",\"stem\"],\"description\":[null,null,null,null,null,null,null,null,null,null,null,null],\"status\":[\"uptodate\",\"outdated\",\"uptodate\",\"uptodate\",\"outdated\",\"outdated\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"outdated\"],\"seconds\":[null,0,0.5600000000000001,0.06,null,0,null,null,0.01,null,null,0],\"bytes\":[null,313,2915,2279,null,16642,null,null,132633,null,null,53],\"branches\":[null,null,null,null,null,null,null,null,null,null,null,null],\"label\":[\"clean_data\",\"coefs\",\"data\",\"data_c\",\"fit_model\",\"model\",\"model_coefs\",\"model_r2\",\"plot\",\"plot_data\",\"pull_data\",\"r2\"],\"color\":[\"#354823\",\"#78B7C5\",\"#354823\",\"#354823\",\"#78B7C5\",\"#78B7C5\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#78B7C5\"],\"id\":[\"clean_data\",\"coefs\",\"data\",\"data_c\",\"fit_model\",\"model\",\"model_coefs\",\"model_r2\",\"plot\",\"plot_data\",\"pull_data\",\"r2\"],\"level\":[1,5,2,3,1,4,1,1,4,1,1,5],\"shape\":[\"triangle\",\"dot\",\"dot\",\"dot\",\"triangle\",\"dot\",\"triangle\",\"triangle\",\"dot\",\"triangle\",\"triangle\",\"dot\"]},\"edges\":{\"from\":[\"model\",\"model_coefs\",\"pull_data\",\"clean_data\",\"data\",\"data_c\",\"fit_model\",\"data_c\",\"plot_data\",\"model_r2\",\"model\"],\"to\":[\"coefs\",\"coefs\",\"data\",\"data_c\",\"data_c\",\"model\",\"model\",\"plot\",\"plot\",\"r2\",\"r2\"],\"color\":[\"#78B7C5\",\"#78B7C5\",\"#354823\",\"#354823\",\"#354823\",\"#78B7C5\",\"#78B7C5\",\"#354823\",\"#354823\",\"#78B7C5\",\"#78B7C5\"],\"arrows\":[\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":{\"type\":\"cubicBezier\",\"forceDirection\":\"horizontal\"}},\"physics\":{\"stabilization\":false},\"interaction\":{\"zoomSpeed\":1},\"layout\":{\"hierarchical\":{\"enabled\":true,\"levelSeparation\":180,\"direction\":\"LR\"}}},\"groups\":null,\"width\":null,\"height\":null,\"idselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":{\"text\":\"\",\"style\":\"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;\"},\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":{\"from\":1,\"to\":1},\"algorithm\":\"hierarchical\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":true,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"legend\":{\"width\":0.2,\"useGroups\":false,\"position\":\"right\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true,\"nodes\":{\"label\":[\"Up to date\",\"Outdated\",\"Function\",\"Stem\"],\"color\":[\"#354823\",\"#78B7C5\",\"#899DA4\",\"#899DA4\"],\"shape\":[\"dot\",\"dot\",\"triangle\",\"dot\"]},\"nodesToDataframe\":true},\"tooltipStay\":300,\"tooltipStyle\":\"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\nWe can see that the `fit_model()` function became outdated after we changed its code and saved the file. Consequently, all downstream targets are now outdated too. You can see that `model`, `coefs`, and `r2` all are dependencies of our function. All other functions and targets that are not related to `fit_model()` remain unchanged. To fix this, we need to update our pipeline.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntar_make() # re-running our pipeline's outdated objects\n```\n:::\n\n\n\nSee how the only other objects that changed are the downstream dependencies of `fit_model()`? This can save an immense amount of headache! Let's go ahead and look at the visual again and try re-running everything.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntar_visnetwork()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"visNetwork html-widget html-fill-item\" id=\"htmlwidget-f656a78b5846a7bd3d7e\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-f656a78b5846a7bd3d7e\">{\"x\":{\"nodes\":{\"name\":[\"clean_data\",\"coefs\",\"data\",\"data_c\",\"fit_model\",\"model\",\"model_coefs\",\"model_r2\",\"plot\",\"plot_data\",\"pull_data\",\"r2\"],\"type\":[\"function\",\"stem\",\"stem\",\"stem\",\"function\",\"stem\",\"function\",\"function\",\"stem\",\"function\",\"function\",\"stem\"],\"description\":[null,null,null,null,null,null,null,null,null,null,null,null],\"status\":[\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\"],\"seconds\":[null,0,0.5600000000000001,0.06,null,0,null,null,0.01,null,null,0.01],\"bytes\":[null,341,2915,2279,null,20852,null,null,132633,null,null,54],\"branches\":[null,null,null,null,null,null,null,null,null,null,null,null],\"label\":[\"clean_data\",\"coefs\",\"data\",\"data_c\",\"fit_model\",\"model\",\"model_coefs\",\"model_r2\",\"plot\",\"plot_data\",\"pull_data\",\"r2\"],\"color\":[\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\"],\"id\":[\"clean_data\",\"coefs\",\"data\",\"data_c\",\"fit_model\",\"model\",\"model_coefs\",\"model_r2\",\"plot\",\"plot_data\",\"pull_data\",\"r2\"],\"level\":[1,5,2,3,1,4,1,1,4,1,1,5],\"shape\":[\"triangle\",\"dot\",\"dot\",\"dot\",\"triangle\",\"dot\",\"triangle\",\"triangle\",\"dot\",\"triangle\",\"triangle\",\"dot\"]},\"edges\":{\"from\":[\"model\",\"model_coefs\",\"pull_data\",\"clean_data\",\"data\",\"data_c\",\"fit_model\",\"data_c\",\"plot_data\",\"model_r2\",\"model\"],\"to\":[\"coefs\",\"coefs\",\"data\",\"data_c\",\"data_c\",\"model\",\"model\",\"plot\",\"plot\",\"r2\",\"r2\"],\"color\":[\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\"],\"arrows\":[\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":{\"type\":\"cubicBezier\",\"forceDirection\":\"horizontal\"}},\"physics\":{\"stabilization\":false},\"interaction\":{\"zoomSpeed\":1},\"layout\":{\"hierarchical\":{\"enabled\":true,\"levelSeparation\":180,\"direction\":\"LR\"}}},\"groups\":null,\"width\":null,\"height\":null,\"idselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":{\"text\":\"\",\"style\":\"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;\"},\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":{\"from\":1,\"to\":1},\"algorithm\":\"hierarchical\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":true,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"legend\":{\"width\":0.2,\"useGroups\":false,\"position\":\"right\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true,\"nodes\":{\"label\":[\"Up to date\",\"Function\",\"Stem\"],\"color\":[\"#354823\",\"#899DA4\",\"#899DA4\"],\"shape\":[\"dot\",\"triangle\",\"dot\"]},\"nodesToDataframe\":true},\"tooltipStay\":300,\"tooltipStyle\":\"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n\n```{.r .cell-code}\ntar_make()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n✔ skipped pipeline [81ms, 6 skipped]\n```\n\n\n:::\n:::\n\n\n\nThe network is all up to date and all 6 targets in the pipeline were skipped. \n\n## Reporting \n\nYou are all finished with your workflow beginning to end in the `{targets}` pipeline, now what? If I am writing a report, I usually create a Quarto markdown file (qmd) and use `tar_load()` at the beginning of with package loading to load in all of the target outputs I need. This keeps your lengthy data processing and analysis code separate from the final written product. Now whenever you render your report, you aren't re-running your entire analysis every time. You are simply just loading in the final and updated targets objects (data/graphs/tables/etc.) that you need! You just need to make sure that your report file lives in the same directory as your `_targets.R` script.\n\n<br>\n\n## Final thoughts\n\nAnd there you have it! An introduction to `{targets}` by [@Landau2021a]. I encourage you to dive into [The {targets} R package user manual](https://books.ropensci.org/targets/) for a deeper look at the package and other cool features I did not mention here [@Landau2021b]. The package can be used in many different ways outside of statistical analyses. It can be expanded to many different aspects of R workflows regardless of your field. While it can be intimidating at first to hop on board with targets, I promise you that your future self will thank you when you have to revise your workflow.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/vis-9.1.0/vis-network.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/vis-9.1.0/vis-network.min.js\"></script>\n<script src=\"../../site_libs/visNetwork-binding-2.1.2/visNetwork.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}